[[Файл:Carl Jacobi.jpg|right|thumb|Карл Густав Якоб Якоби]]
'''Символ Якоби''' — [[теория чисел|теоретико-числовая]] функция двух [[аргумент функции|аргументов]], введённая [[Якоби, Карл Густав Якоб|К. Якоби]] в [[1837 год]]у. Является квадратичным [[Характер (теория чисел)|характером]] в [[кольцо вычетов|кольце вычетов]].

Символ Якоби обобщает [[символ Лежандра]] на все [[нечётные числа]], большие единицы. [[Символ Кронекера — Якоби]], в свою очередь, обобщает символ Якоби на все [[целые числа]], но в практических задачах символ Якоби играет гораздо более важную роль, чем символ Кронекера — Якоби.

== Определение ==

Пусть <math>P</math> — [[нечётное число|нечётное]], большее единицы число и <math>P=p_1p_2\cdots p_n</math> — его разложение на [[простое число|простые]] множители (среди <math>p_1, ..., p_n</math> могут быть равные). Тогда для произвольного [[целое число|целого]] числа <math>a</math> символ Якоби определяется равенством:
: <math>\left(\frac{a}{P}\right) = \left(\frac{a}{p_1}\right)\left(\frac{a}{p_2}\right)\cdots\left(\frac{a}{p_n}\right) </math>,
где <math>\left(\frac{a}{p_i}\right)</math> — [[символ Лежандра|символы Лежандра]].

По определению считаем, что <math>\left(\frac{a}{1}\right)=1</math> для всех ''a''.

== Свойства ==
[[Файл: JacobiSymbol.JPG|right|300px|thumb|Значения символа Якоби для аргументов от 1 до 100]]

* [[Мультипликативная функция|Мультипликативность]]: <math>\left(\frac{ab}{P}\right) = \left(\frac{a}{P}\right) \left(\frac{b}{P}\right)</math>
** В частности, <math>\left(\frac{a^2b}{P}\right) =\left(\frac{b}{P}\right)</math>
* [[Периодическая функция|Периодичность]]: если <math>a\equiv b \pmod P</math>, то
*: <math> \left(\frac{a}{P}\right) = \left(\frac{b}{P}\right) </math>
* <math>\left(\frac{1}{P}\right) = 1</math>
* <math>\left(\frac{-1}{P}\right) = (-1)^{\frac{P-1}{2}}</math>
* <math>\left(\frac{2}{P}\right) = (-1)^{\frac{P^2-1}{8}}</math>
* Если <math>Q </math> — нечётное натуральное число, [[взаимно простые числа|взаимно простое]] с <math>P</math>, то <math>\left(\frac{Q}{P}\right) \left(\frac{P}{Q}\right) = (-1)^{\frac{P-1}{2}\cdot\frac{Q-1}{2}}</math> — аналог [[квадратичный закон взаимности|квадратичного закона взаимности]].
** В частности, если <math>P</math> и <math>Q</math> [[взаимно простые числа|взаимно простые]] и нечётные, то <math>\left(\frac{Q}{P}\right) = (-1)^{\frac{P-1}{2}\cdot\frac{Q-1}{2}}\left(\frac{P}{Q}\right) </math>
* Символ Якоби <math>\left(\frac{a}{P}\right)</math> равен [[знак перестановки|знаку перестановки]] [[приведённая система вычетов|приведённой системы вычетов]] по модулю <math>P</math>, которая задается как умножение элементов этой группы на <math>a</math> (где <math>a</math> обязательно взаимно просто с <math>P</math>).

== Важные замечания ==

=== О вычислении ===

Символ Якоби практически никогда не вычисляют по определению. Чаще всего для вычисления используют свойства символа Якоби, главным образом — квадратичный закон взаимности.

Более того, несмотря на то, что символ Якоби является обобщением [[символ Лежандра|символа Лежандра]] и определяется через него, чаще именно символ Лежандра вычисляют с помощью символа Якоби, а не наоборот. См. [[#Пример|Пример]]

=== О связи с квадратичными сравнениями ===

В отличие от символа Лежандра, символ Якоби нельзя напрямую использовать для проверки разрешимости квадратичного сравнения. То есть, если задано сравнение

{{Формула
|<math>x^2 \equiv a \mod{n},</math>|(1)}}

то равенство единице символа Якоби <math>\left(\frac{a}{n}\right)</math> вовсе не означает, что данное сравнение разрешимо. Например, <math>\left(\frac{2}{15}\right) = (-1)^{28}=1</math>, но сравнение <math>x^2\equiv2\mod{15}</math> не имеет решений (можно проверить перебором).

Но если <math>\left(\frac{a}{n}\right)=-1</math>, то сравнение (1) не имеет решений.

=== Особенность, используемая в тестах простоты ===

В общем случае неверно, что для символа Якоби выполняется то же условие, что и для символа Лежандра:

{{Формула
|<math>\left(\frac{a}{P}\right)  \equiv a^{\frac{P-1}{2}} \mod{P}.</math>|(2)}}

Например,
: <math>\left(\frac{7}{15}\right)= \left(\frac{7}{5}\right)\cdot \left(\frac{7}{3}\right)= \left(\frac{2}{5}\right)\cdot \left(\frac{1}{3}\right)=(-1)^{\frac{25-1}{8}}\cdot1=-1</math>

При этом <math>7^{\frac{15-1}{2}} \equiv 7^7\equiv13. \mod{15}</math>

Числа ''a'', взаимно простые с ''P'', для которых не выполнено условие (2), называются Эйлеровыми свидетелями непростоты числа ''P'' (поскольку для простого ''P'' условие (2) выполнено).
Если ''P'' — [[составное число]], то такое число ''a'', для которого условие (2) выполнено, называют лжецом для [[критерий Эйлера|теста Эйлера]].
Доказано, что для любого составного ''P'' есть не более ''P/2'' лжецов, различных по модулю ''P''.

Данное свойство используется в вероятностном [[алгоритм Соловея-Штрассена|тесте Соловея-Штрассена]] на простоту. В этом алгоритме выбираются случайные числа ''a'' и для них проверяется условие (2). Если находится свидетель непростоты, то доказано, что число ''P'' — составное. В противном случае говорят, что ''P'' — простое с некоторой [[вероятность]]ю.

== Применение ==

Главным образом, символ Якоби используется для быстрого вычисления [[Символ Лежандра|символа Лежандра]].
Символ Лежандра, в свою очередь, необходим для проверки разрешимости квадратичного сравнения по модулю простого числа.
Но считать его по определению (то есть вычислять <math>a^{\frac{p-1}{2}}\mod{p}</math>) — достаточно долгая по времени процедура.
С помощью алгоритма [[Быстрое возведения в степень|быстрого возведения в степень]] это делается за <math>O((\log{p})^3)</math> битовых операций (если не использовать быстрое умножение и деление).
А вычисление символа Якоби требует только <math>O((\log{p})^2)</math> битовых операций.

Символ Якоби используется в некоторых [[тест простоты|тестах на простоту]], например, в [[(N+1) – метод проверки простоты|(N+1) — методах]] и, [[#Особенность, используемая в тестах простоты|как уже было сказано]], в [[Алгоритм Соловея-Штрассена|тесте Соловея — Штрассена]].

== Алгоритм ==

=== Основная идея ===

Ключевое используемое при вычислении свойство символа Якоби — квадратичный закон взаимности. Благодаря нему алгоритм похож на [[алгоритм Евклида]] нахождения [[наибольший общий делитель|наибольшего общего делителя]] двух чисел, в котором тоже аргументы на каждом шаге меняются местами. Аналогично [[алгоритм Евклида|алгоритму Евклида]], при перестановке аргументов больший заменяется на остаток от деления на меньший. Это возможно благодаря [[Периодическая функция|периодичности]] символа Якоби. Однако, поскольку символ Якоби определён только при условии нечётности второго аргумента, то до перестановки выделяется чётная часть первого аргумента.

=== Формальное описание ===

'''Входные данные:''' ''a'' — целое число, ''b'' — натуральное, нечётное, больше единицы..

'''Выходные данные:''' <math>\left(\frac{a}{b}\right)</math> — символ Якоби

  
 '''1''' ''(проверка взаимной простоты).'' Если НОД (''a'', ''b'') ≠1, выход из алгоритма с ответом '''0'''.
 
 '''2''' ''(инициализация).'' ''r'':=1 
 
 '''3''' ''(переход к положительным числам).''
  '''Если''' ''a<0'' '''то'''
   ''a:=-a''
   '''Если''' ''b'' mod 4 = 3 '''то''' ''r:=-r''
  '''Конец если'''
 
 '''4''' ''(избавление от чётности).'' ''t'':=0
  '''Цикл''' ПОКА ''a'' – чётное
   ''t:=t+1''
   ''a:=a/2''
  '''Конец цикла'''
  '''Если''' ''t'' – нечётное, '''то''' 
   '''Если''' ''b'' mod 8 = 3 или 5, '''то''' ''r'':=-''r''.
  '''Конец если'''
 
 '''5''' ''(квадратичный закон взаимности).'' '''Если''' ''a'' mod 4 = ''b'' mod 4 = 3, '''то''' ''r'':=-''r''.
   c:=a; a:=b mod c; b:=c.
 
 '''6''' ''(выход из алгоритма?).'' Если ''a''≠0, то идти на шаг 4, иначе выйти из алгоритма с ответом '''r'''.

=== Комментарии к алгоритму ===

В алгоритме везде берётся наименьший положительный вычет (то есть остаток от деления).

На четвёртом шаге используется [[Мультипликативная функция|мультипликативность]] символа Якоби, а затем вычисляется символ Якоби <math>\left(\frac{2}{b}\right) =(-1)^{(b^2-1)/8}</math>. Чтобы избежать лишнего возведения в степень, проверяется только остаток от деления ''b'' на 8.

На пятом шаге тоже вместо возведения в степень используется проверка остатков от деления.

Сложность алгоритма равна <math>O(\log{a}\cdot\log{b})</math> битовых операций.

== Пример вычисления ==

Вычисление символа Лежандра с помощью символа Якоби:
: <math>\left(\frac{219}{383}\right) = -\left(\frac{383}{219}\right) = -\left(\frac{164}{219}\right) =-\left(\frac{41}{219}\right) = - \left(\frac{219}{41}\right) = - \left(\frac{14}{41}\right) = </math>
: <math> = - \left(\frac{2}{41}\right) \left(\frac{7}{41}\right) =- \left(\frac{7}{41}\right) = - \left(\frac{41}{7}\right) = - \left(\frac{-1}{7}\right) = 1</math>


== Список литературы ==

* {{книга
|подзаголовок
|заглавие=Теоретико-числовые алгоритмы в криптографии
|оригинал=
|ссылка=
|автор=Василенко О.Н. 
|год=2003
|место= Москва
|издательство=МЦМНО
|страницы=328
|isbn= 5-94057-103-4 
}}

* {{книга
|подзаголовок
|заглавие= Основы теории чисел
|оригинал=
|ссылка=http://www.mccme.ru/free-books/djvu/vinogradov.djvu
|автор= Виноградов И. М.
|год=1952
|место=Москва
|издательство= ГИТТЛ
|страницы=
|isbn=
}}

* {{книга
|подзаголовок
|заглавие= Algorithmic Number Theory.Vol. I.
|оригинал=
|ссылка=
|автор=Bach E., Shallit J.
|год=1996
|место=Massachusetts
|издательство= MIT Press
|страницы=
|isbn=0-262-02405-5
}}

{{Характеры}}

{{хорошая статья|Математика}}

[[Категория:Теория чисел]]

[[bn:জ্যাকবি প্রতীক]]
[[ca:Símbol de Jacobi]]
[[de:Jacobi-Symbol]]
[[en:Jacobi symbol]]
[[eo:Jakobia simbolo]]
[[es:Símbolo de Jacobi]]
[[fr:Symbole de Jacobi]]
[[hu:Jacobi-szimbólum]]
[[it:Simbolo di Jacobi]]
[[km:សញ្ញាយ៉ាកូប៊ី]]
[[ko:야코비 기호]]
[[nl:Jacobi-symbool]]
[[pl:Symbol Jacobiego]]
[[pt:Símbolo de Jacobi]]
[[uk:Символ Якобі]]
[[vi:Kí hiệu Jacobi]]
[[zh:雅可比符号]]