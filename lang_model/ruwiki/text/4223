'''Парадо́кс дней рожде́ния''' — утверждение, гласящее, что если дана группа из 23 или более человек, то вероятность того, что хотя бы у двух из них [[день рождения|дни рождения]] (число и месяц) совпадут, превышает 50 %. Для группы из 60 или более человек вероятность совпадения дней рождения хотя бы у двух её членов составляет более 99 %, хотя 100 % она достигает, только когда в группе не менее 367 человек <!--ровно на 1 больше чем дней в году-->(с учётом високосных лет).

Такое утверждение может показаться противоречащим [[здравый смысл|здравому смыслу]], так как вероятность одному родиться в определённый день года довольно мала, а вероятность того, что двое родились в конкретный день — ещё меньше, но является верным в соответствии с [[теория вероятностей|теорией вероятностей]]. Таким образом, оно не является [[парадокс]]ом в строгом [[наука|научном смысле]] — логического противоречия в нём нет, а парадокс заключается лишь в различиях между [[интуиция|интуитивным]] восприятием ситуации человеком и результатами [[математика|математического]] расчёта.

== Интуитивное восприятие ==
Один из способов понять на интуитивном уровне, почему в группе из 23 человек вероятность совпадения дней рождения у двух человек столь высока, состоит в осознании следующего факта: поскольку рассматривается вероятность совпадения дней рождения у ''любых'' двух человек в группе, то эта вероятность определяется количеством ''пар'' людей, которые можно составить из 23 человек. Так как порядок людей в парах не имеет значения, то общее число таких пар равно [[число сочетаний|числу сочетаний]] из 23 по 2, то есть 23&nbsp;×&nbsp;22/2 = 253 пары. Посмотрев на это число, легко понять, что при рассмотрении 253 пар людей вероятность совпадения дней рождения хотя бы у одной пары будет достаточно высокой.

Ключевым моментом здесь является то, что утверждение парадокса дней рождения говорит именно о совпадении дней рождения у ''каких-либо'' двух членов группы. Одно из распространённых заблуждений состоит в том, что этот случай путают с другим — похожим, на первый взгляд, — случаем, когда из группы выбирается один человек и оценивается вероятность того, что у кого-либо из других членов группы день рождения совпадёт с днем рождения выбранного человека. В последнем случае вероятность совпадения значительно ниже.

== Расчёт вероятности ==
В данном примере для расчёта вероятности того, что в группе из ''n'' человек как минимум у двух дни рождения совпадут, примем, что дни рождения [[дискретное равномерное распределение|распределены равномерно]], то есть нет [[Високосный год|високосных лет]], [[Близнецы|близнецов]], рождаемость не зависит от дня недели, [[Времена года|времени года]] и других факторов. В действительности, это не совсем так — обычно летом рождается больше детей; кроме того, в некоторых странах из-за особенностей работы больниц больше детей рождается в определённые дни недели. Однако неравномерность распределения может лишь увеличить вероятность совпадения дней рождения, но не уменьшить: если бы все люди рождались только в 3 дня из 365, то вероятность совпадения дней рождения была бы очень высокой.

Рассчитаем сначала, какова вероятность ''<u style="text-decoration:overline">p</u>&nbsp;''(''n'') того, что в группе из ''n'' человек дни рождения всех людей будут различными. Если ''n'' &gt; 365, то в силу [[Принцип ящиков Дирихле|принципа Дирихле]] вероятность равна нулю. Если же ''n'' ≤ 365, то будем рассуждать следующим образом. Возьмём наугад одного человека из группы и запомним его день рождения. Затем возьмём наугад второго человека, при этом вероятность того, что у него день рождения не совпадёт с днем рождения первого человека, равна 1 — 1/365. Затем возьмём третьего человека, при этом вероятность того, что его день рождения не совпадёт с днями рождения первых двух, равна 1 — 2/365. Рассуждая по аналогии, мы дойдём до последнего человека, для которого вероятность несовпадения его дня рождения со всеми предыдущими будет равна 1 — (''n — 1'')/365. Перемножая все эти вероятности, получаем вероятность того, что все дни рождения в группе будут различными:

: <math>\bar p(n) = 1 \cdot \left(1-\frac{1}{365}\right) \cdot \left(1-\frac{2}{365}\right)  \cdots \left(1-\frac{n-1}{365}\right) = { 365 \cdot 364 \cdots (365-n+1) \over 365^n } = { 365! \over 365^n (365-n)!},</math>

Тогда вероятность того, что хотя бы у двух человек из ''n'' дни рождения совпадут, равна

: <math> p(n) = 1 - \bar p(n) .</math>

Значение этой функции превосходит 1/2 при ''n'' = 23 (при этом вероятность совпадения равна примерно 50.7 %). Вероятности для некоторых значений ''n'' иллюстрируются следующей таблицей:
{| class="wikitable"
!''n''!!''p''&nbsp;(''n'')
|-
|10 || 12 %
|-
|20 || 41 %
|-
|30 || 70 %
|-
|50 || 97 %
|-
|100 || 99,99996 %
|-
|200 || 99,9999999999999999999999999998 %
|-
|300 || (1 − 7×10<sup>−73</sup>) × 100 %
|-
|350 || (1 − 3×10<sup>−131</sup>) × 100 %
|-
|367 || 100 %
|}

Данную задачу можно переформулировать в терминах классической «задачи о совпадениях». Пусть урна содержит ''M''(в данном случае 365) шаров, занумерованных числами 1,2,…''M''. Производится выборка с возвращением объёма ''n''(в данном случае количество человек в группе), при этом рассматриваемые выборки считаются упорядоченными (то есть выборка 1,2,4,6 и 4,2,6,1 считаются различными). Требуется посчитать вероятность события, заключающегося в отсутствии повторений в выборке (все расчёты аналогичны приведённым выше).

== Альтернативный метод расчёта ==
Вероятность совпадения дней рождения в группе можно также рассчитать с использованием формул [[комбинаторика|комбинаторики]]. Представим, что каждый день года — это одна буква в алфавите из 365 букв. Дни рождения ''n'' человек могут быть представлены строкой, состоящей из ''n'' букв такого алфавита. Общее число таких строк равно

: <math>n_\mathrm{total} = 365^{n}\,</math>

Общее число строк, в которых буквы не повторяются, составит

: <math>n_\mathrm{unique} = \frac{365!}{(365-n)!}</math>

Тогда, если строки выбираются случайно (с [[дискретное равномерное распределение|равномерным распределением]]), то вероятность выбрать строку, в которой хотя бы две буквы совпадут, равна

: <math>p(n) = 1 - \frac{n_\mathrm{unique}}{n_\mathrm{total}} = 1 - \frac{\frac{365!}{(365-n)!}}{365^{n}}</math>
для ''n''&nbsp;≤&nbsp;365 и ''p''&nbsp;(''n'')&nbsp;=&nbsp;1 для ''n''&nbsp;>&nbsp;365.

Поскольку

: <math>\frac{\left(\frac{365!}{(365-n)!}\right)}{365^{n}}=\frac{365\cdot 364\cdot 363 \cdots (365-n+1)}{365^{n}}=</math>

: <math>\frac{365}{365}\frac{364}{365}\frac{363}{365}\cdots \frac{365-n+1}{365}=1 \cdot \left(1-\frac{1}{365}\right) \cdot \left(1-\frac{2}{365}\right)  \cdots \left(1-\frac{n-1}{365}\right) ,</math>

то это выражение эквивалентно представленному выше.

== Аппроксимации ==
Используя разложение [[экспоненциальная функция|экспоненциальной функции]] в [[ряд Тейлора]]

: <math> e^x = 1 + x + \frac{x^2}{2!}+\cdots </math>

приведённое выше выражение, дающее значение ''<u style="text-decoration:overline">p</u>''&nbsp;(''n''), можно [[аппроксимация|аппроксимировать]] следующим образом:
[[Файл:050329-birthday2-ru.png|thumb|right|290px|График, показывающий соотношение между точным значением и аппроксимацией ''p''&nbsp;(''n'')]]

: <math>\bar p(n) \approx 1 \cdot e^{-1/365} \cdot e^{-2/365} \cdots e^{-(n-1)/365}  </math>

:: <math>= 1 \cdot e^{-(1+2+ \cdots +(n-1))/365}</math>

:: <math>= e^{-(n(n-1))/2 \cdot 365}</math>

Следовательно,

: <math> p(n) = 1-\bar p(n) \approx 1 - e^{-(n(n-1))/2 \cdot 365}</math>

Для ещё более грубой аппроксимации можно взять выражение

: <math>p(n)\approx 1-e^{-n^2/{2 \cdot 365}},\,</math>

которое, как показывает график, всё ещё даёт достаточную точность.

Приведём ещё одну аппроксимацию.

Вероятность того, что у двух людей день рождения не совпадает равна 364/365.В группе из ''n'' человек ''C''(''n'',&nbsp;2)=''n(n-1)/2'' пар. Поэтому вероятность ''<u style="text-decoration:overline">p</u>''&nbsp;(''n''), при условии независимости этих событий, может быть приближена числом
: <math>\left(\frac{364}{365}\right)^{C(n,2)}.</math>
Следовательно, получаем приближение для искомой вероятности ''p''&nbsp;(''n'')
: <math>p(n) \approx 1 - \left(\frac{364}{365}\right)^{C(n,2)}.</math>

== Пуассоновское приближение ==
Используя приближение Пуассона для бинома, исходя из предыдущего приближения для ''p''&nbsp;(''n''), получим
: <math>\mathrm{Poi}\left(\frac{C(23, 2)}{365}\right) =\mathrm{Poi}\left(\frac{253}{365}\right) \approx \mathrm{Poi}(0.6932)</math>

: <math>\Pr(X>0)=1-\Pr(X=0)=1-e^{-0.6932}=1-0.499998=0.500002.</math>
чуть больше 50 %.

== Подсчёт количества людей для 50 % вероятности ==
используя предыдущую формулу для подсчёта ''p''&nbsp;(''n''), мы можем выразить ''n'',считая ''p''&nbsp;(''n'') равной 50 %,получим
: <math>n \approx \frac{1}{2} + \sqrt{\frac{1}{4} - 2 \times 365 \times \ln(0.5)} = 22.9999.</math>

Есть ещё один способ оценки ''n'' для 50 % вероятности.
Как доказывалось выше

: <math>1-p(n) = \bar p(n) = \prod_{k=1}^{n-1}\left(1-{k \over 365}\right) .</math>

Найдём наименьшее ''n'',для которого ''p''(''n'')&nbsp;>&nbsp;1/2; или, что то же самое,''<u style="text-decoration:overline">p</u>''(''n'')&nbsp;<&nbsp;1/2.

Используя разложение экспоненты в ряд Тейлора, получим 1&nbsp;−&nbsp;''x''&nbsp;<&nbsp;''e''<sup>−''x''</sup>. И следовательно,

: <math>\bar p(n) = \prod_{k=1}^{n-1}\left(1-{k \over 365}\right) < \prod_{k=1}^{n-1}\left(e^{-k/365}\right) = e^{-(n(n-1))/(2\times 365)} .</math>

Так как ''<u style="text-decoration:overline">p</u>''(''n'')&nbsp;<&nbsp;1/2,

: <math> e^{-(n(n-1))/(2\cdot 365)} < \frac{1}{2}</math>

Решая относительно ''n'',получаем

: <math>n^2-n > 2\times365\ln 2 \,\! .</math>

Отсюда находим ''n'' равно 23.

== Родившиеся в один день с заданным человеком ==
[[Файл:Birthday paradox.svg|thumb|right|290px|Сравнение вероятностей ''p''&nbsp;(''n'') и ''q''&nbsp;(''n'')]]
Интересно сравнить вероятность ''p''&nbsp;(''n'') с вероятностью того, что в группе из ''n'' человек у кого-либо день рождения совпадет с днём рождения некоторого заранее выбранного человека (не принадлежащего к этой группе). Эта вероятность равна

: <math> q(n) = 1 - \left( \frac{365-1}{365} \right)^n </math>

Подставляя ''n'' = 23, получаем ''q''&nbsp;(''n'') примерно 5,9 %, что лишь немногим лучше одного шанса из 17. Для того, чтобы вероятность совпадения дня рождения с заданным человеком превысила 50 %, число людей в группе должно быть не менее 253. Это число заметно больше, чем половина дней в году (365/2 = 182.5); так происходит из-за того, что у остальных членов группы дни рождения могут совпадать между собой, и это уменьшает вероятность совпадения одного из них с днём рождения заданного человека.

== Задача в общем виде ==
Задача, представленная парадоксом дней рождения, может быть поставлена в общем виде следующим образом: если даны ''n'' [[дискретное равномерное распределение|равномерно распределённых]] случайных чисел в диапазоне от 1 до ''d'', то какова вероятность ''p'' (''n'' ; ''d'') того, что хотя бы два из этих чисел совпадут ?

Рассуждая таким же образом, как описано выше, можно получить общие решения:

: <math>p(n;d) = \begin{cases} 1-\prod_{k=1}^{n-1}\left(1-{k \over d}\right) & n\le d \\ 1 & n > d \end{cases}</math>
: <math>p(n;d) \approx 1 - e^{-(n(n-1))/2d}</math>
: <math>q(n;d) = 1 - \left( \frac{d-1}{d} \right)^n </math>

И наоборот, если ''n(p;d)'' обозначает количество чисел, принимающих зачиния от 1 до ''d'',для которого вероятность того, что хотя бы 2 из них совпадают равно ''p'',то
: <math>n(p;d)\approx \sqrt{2d \cdot \ln\left({1 \over 1-p}\right)}</math>.

Выше парадокс дней рождения был представлен для одного «типа» людей. Можно обобщить задачу, введя несколько «типов».Самый естественный способ:разделить людей на мужчин(''m'') и женщин(''n'').Подсчитаем вероятность того, что хотя бы и одной женщины и у одного мужчины совпадают дни рождения(совпадение дней рождения у двух женщин или у двух мужчин не считаются).Эта вероятность равна

: <math>p_0 = \frac{1}{d^{m+n}} \sum_{i=1}^m \sum_{j=1}^n S_2(m,i) S_2(n,j) \prod_{k=0}^{i+j-1} d - k</math>

где ''d''&nbsp;=&nbsp;365 и ''S''<sub>2</sub> [[число Стирлинга второго рода|Число Стирлинга второго рода]]. Интересно, что нет однозначного ответа на вопрос о числе ''n''+''m'' для конкретной вероятности. Например для 50 % подходит набор из 16 мужчин и 16 женщин, а также набор из 43 мужчин и 6 женщин.

== Приложения ==
Парадокс дней рождения в общем смысле применим к [[хеш-функция]]м: если хеш-функция генерирует ''N''-битное значение, то число случайных входных данных, для которых [[хеш-код]]ы с большой вероятностью дадут [[коллизия хеш-функции|коллизию]] (то есть найдутся равные хеш-коды, полученные на разных входных данных), равно не 2<sup>''N''</sup>, а только около 2<sup>''N''/2</sup>. Это наблюдение используется в [[атака «дней рождения»|атаке «дней рождения»]] на криптографические хеш-функции.
{| class="wikitable" style="white-space:nowrap;"
|-
! rowspan="2"  style="background:lightgrey;" | N
! rowspan="2"  style="background:lightgrey;" | количество различных выходных цепочек<br /><br />(2^N)
! colspan="10" style="background:lightgrey;" | Вероятность хотя бы одной коллизии (p)
|-
! style="background:lightgrey;" | 10<sup>−18</sup>
! style="background:lightgrey;" | 10<sup>−15</sup>
! style="background:lightgrey;" | 10<sup>−12</sup>
! style="background:lightgrey;" | 10<sup>−9</sup>
! style="background:lightgrey;" | 10<sup>−6</sup>
! style="background:lightgrey;" | 0,1 %
! style="background:lightgrey;" | 1 %
! style="background:lightgrey;" | 25 %
! style="background:lightgrey;" | 50 %
! style="background:lightgrey;" | 75 %
|- align="center"
| bgcolor="lightgrey" | 32
| bgcolor="lightgrey" | 4.3 × 10<sup>9</sup>
| 2
| 2
| 2
| 2.9
| 93
| 2.9 × 10³
| 9.3 × 10³
| 5.0 × 10<sup>4</sup>
| 7.7 × 10<sup>4</sup>
| 1.1 × 10<sup>5</sup>
|- align="center"
| bgcolor="lightgrey" | 64
| bgcolor="lightgrey" | 1.8 × 10<sup>19</sup>
| 6.1
| 1.9 × 10²
| 6.1 × 10³
| 1.9 × 10<sup>5</sup>
| 6.1 × 10<sup>6</sup>
| 1.9 × 10<sup>8</sup>
| 6.1 × 10<sup>8</sup>
| 3.3 × 10<sup>9</sup>
| 5.1 × 10<sup>9</sup>
| 7.2 × 10<sup>9</sup>
|- align="center"
| bgcolor="lightgrey" | 128
| bgcolor="lightgrey" | 3.4 × 10<sup>38</sup>
| 2.6 × 10<sup>10</sup>
| 8.2 × 10<sup>11</sup>
| 2.6 × 10<sup>13</sup>
| 8.2 × 10<sup>14</sup>
| 2.6 × 10<sup>16</sup>
| 8.3 × 10<sup>17</sup>
| 2.6 × 10<sup>18</sup>
| 1.4 × 10<sup>19</sup>
| 2.2 × 10<sup>19</sup>
| 3.1 × 10<sup>19</sup>
|- align="center"
| bgcolor="lightgrey" | 256
| bgcolor="lightgrey" | 1.2 × 10<sup>77</sup>
| 4.8 × 10<sup>29</sup>
| 1.5 × 10<sup>31</sup>
| 4.8 × 10<sup>32</sup>
| 1.5 × 10<sup>34</sup>
| 4.8 × 10<sup>35</sup>
| 1.5 × 10<sup>37</sup>
| 4.8 × 10<sup>37</sup>
| 2.6 × 10<sup>38</sup>
| 4.0 × 10<sup>38</sup>
| 5.7 × 10<sup>38</sup>
|- align="center"
| bgcolor="lightgrey" | 384
| bgcolor="lightgrey" | 3.9 × 10<sup>115</sup>
| 8.9 × 10<sup>48</sup>
| 2.8 × 10<sup>50</sup>
| 8.9 × 10<sup>51</sup>
| 2.8 × 10<sup>53</sup>
| 8.9 × 10<sup>54</sup>
| 2.8 × 10<sup>56</sup>
| 8.9 × 10<sup>56</sup>
| 4.8 × 10<sup>57</sup>
| 7.4 × 10<sup>57</sup>
| 1.0 × 10<sup>58</sup>
|- align="center"
| bgcolor="lightgrey" | 512
| bgcolor="lightgrey" | 1.3 × 10<sup>154</sup>
| 1.6 × 10<sup>68</sup>
| 5.2 × 10<sup>69</sup>
| 1.6 × 10<sup>71</sup>
| 5.2 × 10<sup>72</sup>
| 1.6 × 10<sup>74</sup>
| 5.2 × 10<sup>75</sup>
| 1.6 × 10<sup>76</sup>
| 8.8 × 10<sup>76</sup>
| 1.4 × 10<sup>77</sup>
| 1.9 × 10<sup>77</sup>
|}

В белых квадратах написано количество входных данных(количество человек в группе), при котором коллизия будет с заданной вероятностью(проводя аналогию с парадоксом, кол-во различных выходных цепочек равно 365).

Сходный математический аппарат используется для оценки популяции рыб в озёрах методом «capture-recapture». Действительно, если каждую пойманную рыбу помечать и отпускать, то вероятность поймать помеченную рыбу будет расти нелинейно (в соответствии с приведённым выше графиком) с ростом количества попыток. Размер популяции грубо может быть оценен как квадрат числа попыток до первой помеченной пойманной рыбы.

Решение задачи в общем виде находит применение во многих разделах математики, например в недетерминированных алгоритмах [[Факторизация|факторизации]]. Так, одно из самых простых объяснений [[Ρ-алгоритм Полларда|ρ-метода Полларда]] аналогично объяснению парадокса дней рождения: достаточно иметь примерно <math>\sqrt{p}</math> случайных чисел от 0 до <math> n=p q ~</math>, где <math>p < q ~</math> — простые, чтобы хотя бы для одной из пар чисел с высокой вероятностью нашёлся <math>\gcd \left( |x-y|,n \right) > 1</math>, который и будет делителем числа ''n''.

== Обратная проблема ==
1) Поиск наименьшего ''n'',для которого вероятность ''p''(''n'') больше заданного ''p''.

2) Поиск наибольшего ''n'',для которого вероятность ''p''(''n'') меньше заданного ''p''.

Пользуясь выше приведённой формулой, получаем
: <math>n(p;365)\approx \sqrt{2\times 365\ln\left({1 \over 1-p}\right)}.</math>

{| class="wikitable"
|-----
| ''p'' || ''n''
| ''n''↓ || ''p''(''n''↓) || ''n''↑ || ''p''(''n''↑)
|-----
| <span style=>0.01</span>
| 0.14178√365 = <span style=>2.70864</span>
| align="right" | 2 || 0.00274 || align="right" | 3
| <span style=>0.00820</span>
|-----
| 0.05 || 0.32029√365 = 6.11916
| align="right" | 6 || 0.04046 || align="right" | 7 || 0.05624
|-----
| <span style=>0.1</span>
| 0.45904√365 = <span style=> 8.77002</span>
| align="right" | 8 || 0.07434 || align="right" | 9
| <span style=>0.09462</span>
|-----
| <span style=>0.2</span>
| 0.66805√365 = <span style=>12.76302</span>
| align="right" | 12 || 0.16702 || align="right" | 13
| <span style=>0.19441</span>
|-----
| 0.3 || 0.84460√365 = 16.13607
| align="right" | 16 || 0.28360 || align="right" | 17 || 0.31501
|-----
| 0.5 || 1.17741√365 = 22.49439
| align="right" | 22 || 0.47570 || align="right" | 23 || 0.50730
|-----
| 0.7 || 1.55176√365 = 29.64625
| align="right" | 29 || 0.68097 || align="right" | 30 || 0.70632
|-----
| 0.8 || 1.79412√365 = 34.27666
| align="right" | 34 || 0.79532 || align="right" | 35 || 0.81438
|-----
| 0.9 || 2.14597√365 = 40.99862
| align="right" | 40 || 0.89123 || align="right" | 41 || 0.90315
|-----
| 0.95 || 2.44775√365 = 46.76414
| align="right" | 46 || 0.94825 || align="right" | 47 || 0.95477
|-----
| <span style=>0.99</span>
| 3.03485√365 = <span style=>57.98081</span>
| align="right" | 57
| <span style=>0.99012</span>
| align="right" | 58 || 0.99166
|}

== Наилучшая позиция ==
Пусть в комнате находятся ''n-1'' человек, и дни рождения всех присутствующих в комнате различны. Назовём ''g''(''n'') вероятность того, что день рождения вошедшего человека совпадает с кем-нибудь из присутствующих в комнате. Требуется найти ''n'',для которого ''g''(''n'') максимально. Задача сводится к нахождению максимального значения ''p''(''n'')-''p''(''n-1'').
Пользуясь выше приведённой формулой для ''p''(''n''), получаем ''n''=20.

== Среднее число людей ==
Вернёмся к альтернативной проблеме. Сколько в среднем нужно людей для того, чтобы хотя бы у двух из них совпали дни рождения?

Эта проблема имела отношение к алгоритмам [[Хеширование|хеширования]] и была исследована [[Кнут, Дональд Эрвин|Дональдом Кнутом]].
Оказывается, что для задачи в общем виде интересующая нас случайная величина имеет [[математическое ожидание]] равное

<math>\scriptstyle\overline{n}\,=\,1+Q(M)</math>, где

: <math>Q(M)=\sum_{k=1}^{M} \frac{M!}{(M-k)! M^k}.</math>

Функция

: <math>Q(M)= 1 + \frac{M-1}{M} + \frac{(M-1)(M-2)}{M^2} + \cdots + \frac{(M-1)(M-2) \cdots 1}{M^{M-1}}</math>

была исследована [[Сриниваса Рамануджан Айенгор|Сриниваса Рамануджаном Айенгором]], который получил для неё асимптотическое разложение:

: <math>Q(M)\sim\sqrt{\frac{\pi M}{2}}-\frac{1}{3}+\frac{1}{12}\sqrt{\frac{\pi}{2M}}-\frac{4}{135M}+\cdots.</math>

при ''M''&nbsp;=&nbsp;365 имеем среднее число людей равное <math>\scriptstyle\overline{n}\,=\,1+Q(M)\approx 24.61658</math>, немного больше чем число людей, обеспечивающих 50 % вероятность. Как ни удивительно, необходимое число людей равно ''M''&nbsp;+&nbsp;1&nbsp;=&nbsp;366,хотя в среднем нужно лишь 25.

== Совпадение дней рождения у трёх людей ==
Проинтерпретируем задачу следующим образом:какова вероятность того, что в выборке объёма ''n'' из чисел, принимающих значения от 1 до ''M'' будет хотя бы 3 одинаковых числа(в случае дней рождения ''M'' равно 365). Ответом является следующая формула

: <math>1-\frac{1}{M^n}\cdot\sum_{k=0}^{[\frac{n}{2}]}\frac{2k!}{2^k}\ C_n^{2k} C_M^k(M-k)...(M-n+k+1).</math>

== Близкие дни рождения ==
Другое обобщение парадокса дней рождения состоит в постановке задачи о том, сколько человек нужно для того, чтобы вероятность наличия в группе людей, дни рождения которых различаются не более чем на один день (или на два, три дня и так далее), превысила 50 %. Эта задача более сложная, при её решении используется [[принцип включения-исключения]]. Результат (опять-таки в предположении, что дни рождения распределены равномерно) получается следующим:

{| class="wikitable" style="text-align: center"
! Максимальное различие дней рождения, дней !! Необходимое число людей
|-
|1 || 23
|-
|2 || 14
|-
|3 || 11
|-
|4 || 9
|-
|5 || 8
|-
|6 || 8
|-
|7 || 7
|-
|8 || 7
|}

Таким образом, вероятность того, что даже в группе из 7 людей дни рождения хотя бы у двух будут различаться не более чем на неделю, превышает {{nobr|50 %}}.

== См. также ==
* [[Задача о письмах]]
* [[Синхронность]]

== Ссылки ==
* [http://stepanov.lk.net/gardner/hex/hex05.html Парадоксы теории вероятностей]
* [http://www.pgpru.com/%C1%E8%E1%EB%E8%EE%F2%E5%EA%E0/%D1%F2%E0%F2%FC%E8/%D1%F0%E0%E2%ED%E8%F2%E5%EB%FC%ED%FB%E9%CE%E1%E7%EE%F0%C0%EB%E3%EE%F0%E8%F2%EC%EE%E2PGP?show_comments=1 Парадокс дней рождения и стойкость криптографии]
* [http://en.wikipedia.org/wiki/Birthday_problem Парадокс дней рождения(англ. статья)]

== Литература ==
* Секей Г. ''Парадоксы в теории вероятностей и математической статистике.'' РХД, 2003. (ISBN 5-93972-150-8)
* Козлов М. В. ''Элементы теории вероятностей в примерах и задачах.'' МГУ, 1990. (ISBN 5-211-00312-8)
* Ширяев А. Н. ''Вероятность-1.'' МЦНМО, 2007. (ISBN 987-5-94057-036-3)
* {{статья|автор=Goldberg S.|заглавие=A Direct Attack on a Birthday Problem|язык=en|издание=Mathematical Mathematics Magazine|год=May 1976|выпуск=49|страницы=130-132}}
* {{статья|автор=Mosteller F.|заглавие=Understanding the Birthday Problem|язык=en|издание=The Mathematics Teacher|год=May 1962|страницы=322-325}}
{{хорошая статья|Математика}}

[[Категория:Вероятностные парадоксы|Дней рождения]]

[[ca:Problema dels aniversaris]]
[[cs:Narozeninový problém]]
[[da:Fødselsdagsparadokset]]
[[de:Geburtstagsparadoxon]]
[[el:Παράδοξο των γενεθλίων]]
[[en:Birthday problem]]
[[es:Paradoja del cumpleaños]]
[[eu:Urtebetetzeen ebazkizuna]]
[[fi:Syntymäpäiväongelma]]
[[fr:Paradoxe des anniversaires]]
[[gl:Paradoxo do aniversario]]
[[he:פרדוקס יום ההולדת]]
[[hu:Születésnap-paradoxon]]
[[it:Paradosso del compleanno]]
[[ja:誕生日のパラドックス]]
[[ko:생일 문제]]
[[lt:Gimimo dienų paradoksas]]
[[ml:ജന്മദിനപ്രശ്നം]]
[[nl:Verjaardagenparadox]]
[[pl:Paradoks dnia urodzin]]
[[pt:Paradoxo do aniversário]]
[[sv:Födelsedagsparadoxen]]
[[uk:Парадокс днів народження]]
[[ur:سالگرہ مسلئہ]]
[[zh:生日問題]]