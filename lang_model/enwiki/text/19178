[[File:AtmosphericModelSchematic.png|thumb|300px|right|Models use systems of [[differential equations]] based on the laws of [[physics]], [[Fluid dynamics|fluid motion]], and [[chemistry]], and use a coordinate system which divides the planet into a 3D grid.  [[Winds]], [[heat transfer]], [[solar radiation]], [[relative humidity]], and surface [[hydrology]] are calculated within each grid cell, and the interactions with neighboring cells are used to calculate atmospheric properties in the future.|alt=A grid for a numerical weather model is shown. The grid divides the surface of the Earth along meridians and parallels, and simulates the thickness of the atmosphere by stacking grid cells away from the Earth's center. An inset shows the different physical processes analyzed in each grid cell, such as advection, precipitation, solar radiation, and terrestrial radiative cooling.]]
'''Numerical weather prediction''' uses  [[mathematical model]]s of the atmosphere and oceans to [[weather forecasting|predict the weather]] based on current weather conditions. Though first attempted in the 1920s, it was not until the advent of [[computer simulation]] in the 1950s that numerical weather predictions produced realistic results.  A number of global and regional forecast models are run in different countries worldwide, using current weather observations relayed from [[radiosonde]]s or [[weather satellites]] as inputs to the models.

Mathematical models based on the same physical principles can be used to generate either short-term weather forecasts or longer-term climate predictions; the latter are widely applied for understanding  and projecting [[climate change]]. The improvements made to regional models have allowed for significant improvements in [[Tropical cyclone track forecasting|tropical cyclone track]] and [[air quality]] forecasts; however, atmospheric models perform poorly at handling processes that occur in a relatively constricted area, such as [[wildfire]]s. 

Manipulating the vast datasets and performing the complex calculations necessary to modern numerical weather prediction requires some of the most powerful [[supercomputer]]s in the world.  Even with the increasing power of supercomputers, the [[forecast skill]] of numerical weather models only extends to about six days. Factors affecting the accuracy of numerical predictions include the density and quality of observations used as input to the forecasts, along with deficiencies in the numerical models themselves.  Although post-processing techniques such as [[model output statistics]] (MOS) have been developed to improve the handling of errors in numerical predictions, a more fundamental problem lies in the [[Chaos theory|chaotic]] nature of the [[partial differential equation]]s used to simulate the atmosphere. It is impossible to solve these equations exactly, and small errors grow with time (doubling about every five days).  In addition, the partial differential equations used in the model need to be supplemented with [[Parametrization (climate)|parameterizations]] for [[solar radiation]], [[moist processes]] (clouds and [[precipitation (meteorology)|precipitation]]), [[heat transfer|heat exchange]], soil, vegetation, surface water, and the effects of terrain.  In an effort to quantify the large amount of inherent uncertainty remaining in numerical predictions, [[ensemble forecasting|ensemble forecasts]] have been used since the 1990s to help gauge the confidence in the forecast, and to obtain useful results farther into the future than otherwise possible. This approach analyzes multiple forecasts created with an individual forecast model or multiple models.

== History ==
{{Main|History of numerical weather prediction}}
[[File:Two women operating ENIAC.gif|thumb|280px|The ENIAC main control panel at the [[Moore School of Electrical Engineering]]|alt=Two women operating the ENIAC's main control panel. Switches and panels occupy an entire wall.]]
The [[history of numerical weather prediction]] began in the 1920s through the efforts of [[Lewis Fry Richardson]], who used procedures originally developed by [[Vilhelm Bjerknes]]<ref name="Lynch JCP"/> to produce by hand a six-hour forecast for the state of the atmosphere over two points in central Europe, taking at least six weeks to do so.<ref name="Lynch JCP">{{cite journal|last=Lynch|first=Peter|title=The origins of computer weather prediction and climate modeling|journal=[[Journal of Computational Physics]]|year=2008|month=March|volume=227|issue=7|pages=3431<U+2013>44|doi=10.1016/j.jcp.2007.02.034|bibcode=2008JCoPh.227.3431L|publisher=[[University of Miami]]|url=http://www.rsmas.miami.edu/personal/miskandarani/Courses/MPO662/Lynch,Peter/OriginsCompWF.JCP227.pdf|accessdate=2010-12-23}}</ref><ref name="Lynch Ch1">{{cite book|last=Lynch|first=Peter|title=The Emergence of Numerical Weather Prediction|year=2006|publisher=[[Cambridge University Press]]|isbn=978-0-521-85729-1|pages=1<U+2013>27|chapter=Weather Prediction by Numerical Process}}</ref>  It was not until the advent of the computer and [[computer simulation]]s that computation time was reduced to less than the forecast period itself. The [[ENIAC]] was used to create the first weather forecasts via computer in 1950;<ref name="Charney 1950"/><ref>{{cite book|title=Storm Watchers|page=208|year=2002|author=Cox, John D.|publisher=John Wiley & Sons, Inc.|ISBN=0-471-38108-X}}</ref> in 1954, [[Carl-Gustav Rossby]]'s group at the [[Swedish Meteorological and Hydrological Institute]] used the same model to produce the first operational forecast (i.e. routine predictions for practical use).<ref name="Harper BAMS">{{cite journal|last=Harper|first=Kristine|coauthors=Uccellini, Louis W.; Kalnay, Eugenia; Carey, Kenneth; Morone, Lauren|title=2007: 50th Anniversary of Operational Numerical Weather Prediction|journal=[[Bulletin of the American Meteorological Society]]|year=2007|month=May|volume=88|issue=5|pages=639<U+2013>650|doi=10.1175/BAMS-88-5-639|bibcode=2007BAMS...88..639H}}</ref> Operational numerical weather prediction in the United States began in 1955 under the Joint Numerical Weather Prediction Unit (JNWPU), a joint project by the [[U.S. Air Force]], [[U.S. Navy|Navy]] and [[U.S. Weather Bureau|Weather Bureau]].<ref>{{cite web|author=American Institute of Physics|date=2008-03-25|url=http://www.aip.org/history/sloan/gcm/ |title=Atmospheric General Circulation Modeling|accessdate=2008-01-13 |archiveurl = http://web.archive.org/web/20080325084036/http://www.aip.org/history/sloan/gcm/ |archivedate = 2008-03-25}}</ref>  In 1956, Norman Phillips developed a mathematical model which could realistically depict monthly and seasonal patterns in the troposphere; this became the first successful [[climate model]].<ref name="Phillips">{{cite journal|last=Phillips|first=Norman A.|title=The general circulation of the atmosphere: a numerical experiment|journal=Quarterly Journal of the [[Royal Meteorological Society]]|year=1956|month=April|volume=82|issue=352|pages=123<U+2013>154|accessdate=2010-12-31|doi=10.1002/qj.49708235202|bibcode=1956QJRMS..82..123P}}</ref><ref name="Cox210">{{cite book|title=Storm Watchers|page=210|year=2002|author=Cox, John D.|publisher=John Wiley & Sons, Inc.|ISBN=0-471-38108-X}}</ref> Following Phillips' work, several groups began working to create [[general circulation model]]s.<ref name="Lynch Ch10">{{cite book|last=Lynch|first=Peter|title=The Emergence of Numerical Weather Prediction|year=2006|publisher=[[Cambridge University Press]]|isbn=978-0-521-85729-1|pages=206<U+2013>208|chapter=The ENIAC Integrations}}</ref>  The first general circulation climate model that combined both oceanic and atmospheric processes was developed in the late 1960s at the [[NOAA]] [[Geophysical Fluid Dynamics Laboratory]].<ref>{{cite web|url=http://celebrating200years.noaa.gov/breakthroughs/climate_model/welcome.html|title=The First Climate Model|author=[[National Oceanic and Atmospheric Administration]]|date=2008-05-22|accessdate=2011-01-08}}</ref>  

As computers have become more powerful, the size of the initial datasets has increased and [[Atmospheric model#Types|newer atmospheric models]] have been developed to take advantage of the added available computing power. These newer models include more physical processes in the simplifications of the [[Navier<U+2013>Stokes equations|equations of motion]] in numerical simulations of the atmosphere.<ref name="Harper BAMS">{{cite journal|last=Harper|first=Kristine|coauthors=Uccellini, Louis W.; Kalnay, Eugenia; Carey, Kenneth; Morone, Lauren|title=2007: 50th Anniversary of Operational Numerical Weather Prediction|journal=[[Bulletin of the American Meteorological Society]]|year=2007|month=May|volume=88|issue=5|pages=639<U+2013>650|doi=10.1175/BAMS-88-5-639|url=http://journals.ametsoc.org/doi/pdf/10.1175/BAMS-88-5-639|accessdate=2010-12-31}}</ref>  In 1966, [[West Germany]] and the United States began producing operational forecasts based on [[primitive equations|primitive-equation models]], followed by the United Kingdom in 1972 and Australia in 1977.<ref name="Lynch JCP"/><ref name="Leslie BOM">{{cite journal|last=Leslie|first=L.M.|coauthors=Dietachmeyer, G.S.|title=Real-time limited area numerical weather prediction in Australia: a historical perspective|journal=Australian Meteorological Magazine|year=1992|month=December|volume=41|issue=SP|pages=61<U+2013>77|url=http://www.bom.gov.au/amoj/docs/1992/leslie2.pdf|accessdate=2011-01-03|publisher=[[Bureau of Meteorology]]}}</ref>  The development of limited area (regional) models facilitated advances in forecasting the tracks of [[tropical cyclone]]s as well as [[air quality]] in the 1970s and 1980s.<ref name="Shuman W&F">{{cite journal|last=Shuman|first=Frederick G.|authorlink=Frederick Gale Shuman|title=History of Numerical Weather Prediction at the National Meteorological Center|journal=[[Weather and Forecasting]]|year=1989|month=September|volume=4|issue=3|pages=286<U+2013>296|doi=10.1175/1520-0434(1989)004<0286:HONWPA>2.0.CO;2|url=http://journals.ametsoc.org/doi/pdf/10.1175/1520-0434%281989%29004%3C0286%3AHONWPA%3E2.0.CO%3B2|accessdate=2010-12-31|bibcode=1989WtFor...4..286S}}</ref><ref>{{cite book|title=Air pollution modeling and its application VIII, Volume 8|author=Steyn, D. G.|publisher=Birkh<U+00E4>user|year=1991|pages=241<U+2013>242|ISBN=978-0-306-43828-8}}</ref>  By the early 1980s models began to include the interactions of soil and vegetation with the atmosphere, which led to more realistic forecasts.<ref>{{cite journal|url=http://www.geog.ucla.edu/~yxue/pdf/1996jgr.pdf|title=Impact of vegetation properties on U. S. summer weather prediction|page=7419|author=Xue, Yongkang; Fennessey, Michael J.|journal=[[Journal of Geophysical Research]]|volume=101|number=D3|date=1996-03-20|accessdate=2011-01-06|publisher=[[American Geophysical Union]]|doi=10.1029/95JD02169|bibcode=1996JGR...101.7419X}}</ref>  

The output of forecast models based on [[atmospheric dynamics]] is unable to resolve some details of the weather near the Earth's surface. As such, a statistical relationship between the output of a numerical weather model and the ensuing conditions at the ground was developed in the 1970s and 1980s, known as [[model output statistics]] (MOS).<ref name="MOS"/><ref>{{cite book|title=Air Weather Service Model Output Statistics Systems|author=Best, D. L.; Pryor, S. P. |year=1983|pages=1<U+2013>90|publisher=Air Force Global Weather Central}}</ref>  Starting in the 1990s, model ensemble forecasts have been used to help define the forecast uncertainty and to extend the window in which numerical weather forecasting is viable farther into the future than otherwise possible.<ref name="Toth"/><ref name="ECens"/><ref name="RMS"/>

==Initialization==
[[File:Lockheed WP-3D Orion.jpg|280px|thumb|right|Weather reconnaissance aircraft, such as this [[WP-3D Orion]], provide data that is then used in numerical weather forecasts.|alt=A [[WP-3D Orion]] weather reconnaissance aircraft in flight.]]
The [[atmosphere]] is a [[fluid]]. As such, the idea of numerical weather prediction is to sample the state of the fluid at a given time and use the equations of [[fluid dynamics]] and [[thermodynamics]] to estimate the state of the fluid at some time in the future.  The process of entering observation data into the model to generate [[initial value problem|initial conditions]] is called ''initialization''. On land, terrain maps available at resolutions down to {{convert|1|km|mi|1|sp=us}} globally are used to help model atmospheric circulations within regions of rugged topography, in order to better depict features such as downslope winds, [[Lee wave|mountain wave]]s and related cloudiness that affects incoming solar radiation.<ref>{{cite book|url=http://books.google.com/books?id=lMXSpRwKNO8C&pg=PA56&dq=radiation+mountain+parameterization+book&hl=en&ei=WYJaTf-3GYO8lQfSq_WeDQ&sa=X&oi=book_result&ct=result&resnum=2&ved=0CDgQ6AEwAQ#v=onepage&q=radiation%20mountain%20parameterization%20book&f=false|title=Parameterization schemes: keys to understanding numerical weather prediction models|author=Stensrud, David J.|page=56|year=2007|publisher=Cambridge University Press|accessdate=2011-02-15|ISBN=978-0-521-86540-1}}</ref>  The main inputs from country-based weather services are observations from devices (called [[radiosonde]]s) in weather balloons  that measure  various atmospheric parameters and transmits them to a fixed receiver, as well as from [[weather satellite]]s. The [[World Meteorological Organization]] acts to standardize the instrumentation, observing practices and timing of these observations worldwide. Stations either report hourly in [[METAR]] reports,<ref>{{cite web|title=Key to METAR Surface Weather Observations|url=http://www.ncdc.noaa.gov/oa/climate/conversion/swometardecoder.html|publisher=[[National Oceanic and Atmospheric Administration]]|accessdate=2011-02-11|author=[[National Climatic Data Center]]|date=2008-08-20}}</ref> or every six hours in [[SYNOP]] reports.<ref>{{cite web|title=SYNOP Data Format (FM-12): Surface Synoptic Observations|publisher=[[UNISYS]]|accessdate=2011-02-11|archiveurl=http://web.archive.org/web/20071230100059/http://weather.unisys.com/wxp/Appendices/Formats/SYNOP.html|archivedate=2007-12-30|date=2008-05-25}}</ref> These observations are irregularly spaced, so they are processed by [[data assimilation]] and objective analysis methods, which perform quality control and obtain values at locations usable by the model's mathematical algorithms.<ref name="Krishnamurti Ann Rev FM">{{cite journal|last=Krishnamurti|first=T. N.|title=Numerical Weather Prediction|journal=[[Annual Reviews (publisher)|Annual Review of Fluid Mechanics]]|year=1995|month=January|volume=27|issue=1|pages=195<U+2013>225|doi=10.1146/annurev.fl.27.010195.001211|bibcode=1995AnRFM..27..195K}}</ref>  Some global models use [[finite differences]], in which the world is represented as discrete points on a regularly-spaced grid of latitude and longitude;<ref>{{cite book|url=http://books.google.com/books?id=BQ_7vh5SrHQC&pg=PA224&dq=geodesic+grid+numerical+weather+prediction+book&hl=en&ei=EdwlTdPyE4OKlwffn4TlAQ&sa=X&oi=book_result&ct=result&resnum=3&ved=0CDEQ6AEwAg#v=onepage&q=geodesic%20grid%20numerical%20weather%20prediction%20book&f=false|page=224|title=Parallel computational fluid dynamics: parallel computings and its applications : proceedings of the Parallel CFD 2006 Conference, Busan city, Korea (May 15<U+2013>18, 2006)|author=Kwon, J. H.|year=2007|accessdate=2011-01-06|publisher=Elsevier|ISBN=978-0-444-53035-6}}</ref> other models use [[spectral methods]] that solve for a range of wavelengths. The data are then used in the model as the starting point for a forecast.<ref>{{cite web|title=The WRF Variational Data Assimilation System (WRF-Var)|publisher=[[University Corporation for Atmospheric Research]]|accessdate=2011-02-11|archiveurl=http://web.archive.org/web/20070814044336/http://www.mmm.ucar.edu/wrf/WG4/wrfvar/wrfvar-tutorial.htm|archivedate=2007-08-14|date=2007-08-14}}</ref>
 
A variety of methods are used to gather observational data for use in numerical models. Sites launch radiosondes in weather balloons which rise through the [[troposphere]] and well into the [[stratosphere]].<ref>{{cite web|last=Gaffen|first=Dian J.|title=Radiosonde Observations and Their Use in SPARC-Related Investigations|accessdate=2011-02-11|archiveurl=http://web.archive.org/web/20070607142822/http://www.aero.jussieu.fr/~sparc/News12/Radiosondes.html|archivedate=2007-06-07|date=2007-06-07}}</ref> Information from weather satellites is used where traditional data sources are not available.  Commerce provides [[pilot report]]s along aircraft routes<ref>{{cite journal|last=Ballish|first=Bradley A.|coauthors=V. Krishna Kumar|title=Systematic Differences in Aircraft and Radiosonde Temperatures|journal=[[Bulletin of the American Meteorological Society]]|year=2008|month=November|volume=89|issue=11|pages=1689<U+2013>1708|doi=10.1175/2008BAMS2332.1|bibcode=2008BAMS...89.1689B|accessdate=2011-02-16|url=http://amdar.noaa.gov/docs/bams_ballish_kumar.pdf}}</ref> and ship reports along shipping routes.<ref>{{cite web|author=National Data Buoy Center|url=http://www.vos.noaa.gov/vos_scheme.shtml|title=The WMO Voluntary Observing Ships (VOS) Scheme|accessdate=2011-02-15|date=2009-01-28|publisher=[[National Oceanic and Atmospheric Administration]]}}</ref>  Research projects use [[weather reconnaissance|reconnaissance aircraft]] to fly in and around weather systems of interest, such as [[tropical cyclone]]s.<ref name="Hurricane Hunters">{{cite web|year=2011|author=403rd Wing|url=http://www.hurricanehunters.com|title=The Hurricane Hunters|publisher=[[Hurricane Hunters|53rd Weather Reconnaissance Squadron]]|accessdate=2006-03-30}}</ref><ref name="SunHerald">{{cite journal|author=Lee, Christopher|title=Drone, Sensors May Open Path Into Eye of Storm|url=http://www.washingtonpost.com/wp-dyn/content/article/2007/10/07/AR2007100700971_pf.html|journal=The Washington Post|accessdate=2008-02-22|date=2007-10-08}}</ref>  Reconnaissance aircraft are also flown over the open oceans during the cold season into systems which cause significant uncertainty in forecast guidance, or are expected to be of high impact from three to seven days into the future over the downstream continent.<ref>{{cite web|url=http://www.noaanews.noaa.gov/stories2010/20100112_plane.html|title=NOAA Dispatches High-Tech Research Plane to Improve Winter Storm Forecasts|date=2010-11-12|accessdate=2010-12-22|author=[[National Oceanic and Atmospheric Administration]]}}</ref>  Sea ice began to be initialized in forecast models in 1971.<ref>{{cite book|url=http://books.google.com/books?id=lMXSpRwKNO8C&pg=PA137&dq=sea+ice+use+numerical+weather+prediction+book&hl=en&ei=wIkoTYfsOcT6lwfX36mjAQ&sa=X&oi=book_result&ct=result&resnum=6&ved=0CEgQ6AEwBQ#v=onepage&q=sea%20ice%20use%20numerical%20weather%20prediction%20book&f=false|author=Stensrud, David J.|page=137|title=Parameterization schemes: keys to understanding numerical weather prediction models|publisher=[[Cambridge University Press]]|year=2007|accessdate=2011-01-08|ISBN=978-0-521-86540-1}}</ref>  Efforts to involve [[sea surface temperature]] in model initialization began in 1972 due to its role in modulating weather in higher latitudes of the Pacific.<ref>{{cite book|url=http://books.google.com/books?id=SV04AAAAIAAJ&pg=PA38&dq=sea+surface+temperature+importance+use+numerical+weather+prediction+book&hl=en&ei=IYwoTZ7QJ4Odlgenrqm8AQ&sa=X&oi=book_result&ct=result&resnum=8&ved=0CFIQ6AEwBw#v=onepage&q=sea%20surface%20temperature%20importance%20use%20numerical%20weather%20prediction%20book&f=false|pages=49<U+2013>50|title=The Global Climate|author=Houghton, John Theodore|publisher=Cambridge University Press archive|year=1985|accessdate=2011-01-08|ISBN=978-0-521-31256-1}}</ref>

==Computation==
{{Main|Atmospheric model}}
[[File:GFS 850 MB.PNG|right|280px|thumb|A [[prognostic chart]] of the 96-hour forecast of 850 [[millibar|mbar]] [[geopotential height]] and [[temperature]] from the [[Global Forecast System]]|alt=A prognostic chart of the North American continent provides geopotential heights, temperatures, and wind velocities at regular intervals. The values are taken at the altitude corresponding to the 850-millibar pressure surface.]]

An atmospheric model is a computer program that produces [[meteorological]] information for future times at given locations and altitudes.   Within any modern model is a set of equations, known as the [[primitive equations]], used to predict the future state of the atmosphere.<ref>{{cite book|last=Pielke|first=Roger A.|title=Mesoscale Meteorological Modeling|year=2002|publisher=[[Academic Press]]|isbn=0-12-554766-8|pages=48<U+2013>49|accessdate=2011-01-02}}</ref>  These equations<U+2014>along with the [[ideal gas law]]<U+2014>are used to evolve the [[density]], [[pressure]], and [[potential temperature]] [[scalar field]]s and the air [[velocity]] (wind) [[vector field]] of the atmosphere through time. Additional transport equations for pollutants and other [[aerosol]]s are included in some primitive-equation high-resolution models as well.<ref>{{cite book|last=Pielke|first=Roger A.|title=Mesoscale Meteorological Modeling|year=2002|publisher=[[Academic Press]]|isbn=0-12-554766-8|pages=18<U+2013>19|accessdate=2011-02-25}}</ref> The equations used are [[nonlinear system|nonlinear]] partial differential equations which are impossible to solve exactly through analytical methods,<ref name="finite">{{cite book|url=http://books.google.com/books?id=SH8R_flZBGIC&pg=PA165&lpg=PA165&dq=numerical+weather+prediction+partial+differential+equations+book&source=bl&ots=C_jqWj-tu6&sig=kY2D6joPnrFWh9qC3oI0u4BMdoI&hl=en&ei=uBMeTa3EHIH78AaS-_DSDQ&sa=X&oi=book_result&ct=result&resnum=6&ved=0CDwQ6AEwBQ#v=onepage&q=numerical%20weather%20prediction%20partial%20differential%20equations%20book&f=false|title=Finite difference schemes and partial differential equations|author=Strikwerda, John C.|pages=165<U+2013>170|year=2004|publisher=SIAM|ISBN=978-0-89871-567-5|accessdate=2010-12-31}}</ref> with the exception of a few idealized cases.<ref>{{cite book|last=Pielke|first=Roger A.|title=Mesoscale Meteorological Modeling|year=2002|publisher=[[Academic Press]]|isbn=0-12-554766-8|pages=65|accessdate=2011-01-02}}</ref> Therefore, numerical methods obtain approximate solutions.  Different models use different solution methods: some global models and almost all regional models use [[finite difference method]]s for all three spatial dimensions, while other global models and a few regional models use [[spectral method]]s for the horizontal dimensions and  finite-difference methods in the vertical.<ref name="finite"/>

These equations are initialized from the analysis data and rates of change are determined.  These rates of change predict the state of the atmosphere a short time into the future; the time increment for this prediction is called a ''time step''.  The equations are then applied to this new atmospheric state to find new rates of change, and these new rates of change predict the atmosphere at a yet further time step into the future.  This time stepping is repeated until the solution reaches the desired forecast time.  The length of the time step chosen within the model is related to the distance between the points on the computational grid, and is chosen to maintain [[numerical stability]].<ref>{{cite book|last=Pielke|first=Roger A.|title=Mesoscale Meteorological Modeling|year=2002|publisher=[[Academic Press]]|isbn=0-12-554766-8|pages=285<U+2013>287|accessdate=2011-01-02}}</ref>  Time steps for global models are on the order of tens of minutes,<ref>{{cite book|url=http://books.google.com/books?id=JZikIbXzipwC&pg=PA131&lpg=PA131&dq=time+step+numerical+weather+prediction&source=bl&ots=KoeMxpt3_J&sig=7DEG9Sjy6-8O9BVJtNuLnWOBrBo&hl=en&ei=9xshTem6C8GB8gaGzq3fDQ&sa=X&oi=book_result&ct=result&resnum=7&sqi=2&ved=0CEIQ6AEwBg#v=onepage&q=time%20step%20numerical%20weather%20prediction&f=false|page=132|title=|author=Sunderam, V. S.; van Albada, G. Dick; Peter, M. A.; Sloot, J. J. Dongarra|title=Computational Science <U+2013> ICCS 2005: 5th International Conference, Atlanta, GA, USA, May 22<U+2013>25, 2005, Proceedings, Part 1|year=2005|accessdate=2011-01-02|publisher=Springer|ISBN=9783540260325}}</ref> while time steps for regional models are between one and four minutes.<ref>{{cite book|url=http://books.google.com/books?id=UV6PnF2z5_wC&pg=PA276&dq=time+step+WRF+weather&hl=en&ei=iCAhTejVDMOBlAfz6-WcDA&sa=X&oi=book_result&ct=result&resnum=2&ved=0CDIQ6AEwAQ#v=onepage&q=time%20step%20WRF%20weather&f=false|page=276|title=Developments in teracomputing: proceedings of the ninth ECMWF Workshop on the Use of High Performance Computing in Meteorology|author=Zwieflhofer, Walter; Kreitz, Norbert; European Centre for Medium Range Weather Forecasts|year=2001|accessdate=2011-01-02|publisher=World Scientific|ISBN=9789810247614}}</ref>  The global models are run at varying times into the future.  The [[UKMET]] [[Unified Model]] is run six days into the future,<ref name="models">{{cite book|pages=295<U+2013>296|url=http://books.google.com/books?id=6gFiunmKWWAC&pg=PA297&dq=hours+time+used+to+run+ECMWF+model&hl=en&ei=jOZmTZ2QJcOBgAerqODLCg&sa=X&oi=book_result&ct=result&resnum=5&ved=0CDwQ6AEwBA#v=onepage&q=hours%20time%20used%20to%20run%20ECMWF%20model&f=false|title=Global Perspectives on Tropical Cyclones: From Science to Mitigation|author=Chan, Johnny C. L. and Jeffrey D. Kepert|year=2010|publisher=World Scientific|ISBN=9789814293471|accessdate=2011-02-24}}</ref> the [[European Centre for Medium-Range Weather Forecasts]] model is run out to ten days into the future,<ref>{{cite book|url=http://books.google.com/books?id=fhW5oDv3EPsC&pg=PA474&dq=time+used+to+run+ECMWF+model&hl=en&ei=_ORmTY-tDoKClAfWmbD_AQ&sa=X&oi=book_result&ct=result&resnum=6&sqi=2&ved=0CEAQ6AEwBQ#v=onepage&q&f=false|page=480|author=Holton, James R.|title=An introduction to dynamic meteorology, Volume 1|year=2004|publisher=Academic Press|accessdate=2011-02-24|ISBN=9780123540157}}</ref> while the [[Global Forecast System]] model run by the [[Environmental Modeling Center]] is run sixteen days into the future.<ref>{{cite book|url=http://books.google.com/books?id=mTZvR3R6YdkC&pg=PA121&dq=how+long+does+it+take+to+run+the+GFS+global+weather+model+book&hl=en&ei=QOhmTd-wLYOBlAeG2amCAg&sa=X&oi=book_result&ct=result&resnum=2&sqi=2&ved=0CDEQ6AEwAQ#v=onepage&q&f=false|page=121|title=Famine early warning systems and remote sensing data|author=Brown, Molly E.|publisher=Springer|year=2008|accessdate=2011-02-24|ISBN=9783540753674}}</ref> The visual output produced by a model solution is known as a prognostic chart, or ''prog''.<ref>{{cite book|author=Ahrens, C. Donald|page=244|ISBN=978-0-495-11558-8|year=2008|publisher=Cengage Learning|title=Essentials of meteorology: an invitation to the atmosphere|url=http://books.google.com/books?id=2Yn29IFukbgC&pg=PA244&lpg=PA244&dq=regional+weather+forecast+model+characteristics+book&source=bl&ots=iBxiwg0atz&sig=dj58_uKk0k3ef8RxnjbZb76QZ74&hl=en&ei=JyQeTfWZK8H7lweXgYXkCw&sa=X&oi=book_result&ct=result&resnum=6&ved=0CDkQ6AEwBQ#v=onepage&q&f=false|accessdate=2011-02-11}}</ref>

== Parameterization ==
{{Main|Parametrization (climate)}}
Some meteorological processes are too small-scale or too complex to be explicitly included in numerical weather prediction models. ''[[Parameterization]]'' is a procedure for representing these processes by relating them to variables on the scales that the model resolves. For example, the gridboxes in weather and climate models have sides that are between {{convert|5|km|mi|0|sp=us}} and {{convert|300|km|mi|-2|sp=us}} in length.  A typical [[cumulus cloud]] has a scale of less than {{convert|1|km|mi|1|sp=us}}, and would require a grid even finer than this to be represented physically by the equations of fluid motion.  Therefore the processes that such [[cloud]]s represent are parameterized, by processes of various sophistication.  In the earliest models, if a column of air in a model gridbox was conditionally unstable (essentially, the bottom was warmer and moister than the top) and the water vapor content at any point within the column became saturated then it would be overturned (the warm, moist air would begin rising), and the air in that vertical column mixed.  More sophisticated schemes recognize that only some portions of the box might [[convection|convect]] and that [[Entrainment (meteorology)|entrainment]] and other processes occur.  Weather models that have gridboxes with sides between {{convert|5|and|25|km|mi|0|sp=us}} can explicitly represent convective clouds, although they need to parameterize [[cloud microphysics]] which occur at a smaller scale.<ref>{{cite journal|url=http://ams.confex.com/ams/pdfpapers/126017.pdf|title=3.7 Improving Precipitation Forecasts by the Operational Nonhydrostatic Mesoscale Model with the Kain-Fritsch Convective Parameterization and Cloud Microphysics|author=Narita, Masami and Shiro Ohmori|date=2007-08-06|accessdate=2011-02-15|publisher=[[American Meteorological Society]]|journal=12th Conference on Mesoscale Processes}}</ref>  The formation of large-scale ([[stratus cloud|stratus]]-type) clouds is more physically based; they form when the [[relative humidity]] reaches some prescribed value.  Sub-grid scale processes need to be taken into account.  Rather than assuming that clouds form at 100% relative humidity, the [[cloud fraction]] can be related a critical value of relative humidity less than 100%,<ref>{{cite web|url=http://www.atmos.washington.edu/~dargan/591/diag_cloud.tech.pdf|pages=4<U+2013>5|title=The Diagnostic Cloud Parameterization Scheme|author= Frierson, Dargan|publisher=[[University of Washington]]|date=2000-09-14|accessdate=2011-02-15}}</ref> reflecting the sub grid scale variation that occurs in the real world.

The amount of solar radiation reaching the ground, as well as the formation of cloud droplets occur on the molecular scale, and so they must be parameterized before they can be included in the model.  [[Drag (physics)|Atmospheric drag]] produced by mountains must also be parameterized, as the limitations in the resolution of [[elevation]] contours produce significant underestimates of the drag.<ref>{{cite book|url=http://books.google.com/books?id=lMXSpRwKNO8C&pg=PA56&dq=radiation+mountain+parameterization+book&hl=en&ei=WYJaTf-3GYO8lQfSq_WeDQ&sa=X&oi=book_result&ct=result&resnum=2&ved=0CDgQ6AEwAQ#v=onepage&q=radiation%20mountain%20parameterization%20book&f=false|title=Parameterization schemes: keys to understanding numerical weather prediction models|author=Stensrud, David J.|page=6|year=2007|publisher=Cambridge University Press|accessdate=2011-02-15|ISBN=9780521865401}}</ref>  This method of parameterization is also done for the surface flux of energy between the ocean and the atmosphere, in order to determine realistic sea surface temperatures and type of sea ice found near the ocean's surface.<ref>{{cite book|page=188|title=A climate modelling primer|author=McGuffie, K. and A. Henderson-Sellers|publisher=John Wiley and Sons|year=2005|accessdate=2011-02-24|ISBN=9780470857519}}</ref>  Sun angle as well as the impact of multiple cloud layers is taken into account.<ref>{{cite book|url=http://books.google.com/books?id=vdg5BgBmMkQC&pg=PA226&lpg=PA226&dq=radiation+parameterization+book&source=bl&ots=qK-18k7KpQ&sig=Jqv4q_8_WwItR3T93TcC8FHYRow&hl=en&ei=WXxaTejwLsiEtgfWnrXwCw&sa=X&oi=book_result&ct=result&resnum=2&ved=0CBoQ6AEwAQ#v=onepage&q=radiation%20parameterization%20book&f=false|author=Mel<U+02B9>nikova, Irina N. and Alexander V. Vasilyev|pages=226<U+2013>228|title=Short-wave solar radiation in the earth's atmosphere: calculation, oberservation, interpretation|year=2005|publisher=Springer|ISBN=9783540214526}}</ref>  Soil type, vegetation type, and soil moisture all determine how much radiation goes into warming and how much moisture is drawn up into the adjacent atmosphere, and thus it is important to parameterize their contribution to these processes.<ref>{{cite book|url=http://books.google.com/books?id=lMXSpRwKNO8C&pg=PA56&dq=radiation+mountain+parameterization+book&hl=en&ei=WYJaTf-3GYO8lQfSq_WeDQ&sa=X&oi=book_result&ct=result&resnum=2&ved=0CDgQ6AEwAQ#v=onepage&q=radiation%20mountain%20parameterization%20book&f=false|title=Parameterization schemes: keys to understanding numerical weather prediction models|author=Stensrud, David J.|pages=12<U+2013>14|year=2007|publisher=Cambridge University Press|accessdate=2011-02-15|ISBN=9780521865401}}</ref>  Within air quality models, parameterizations take into account atmospheric emissions from multiple relatively tiny sources (e.g. roads, fields, factories) within specific grid boxes.<ref>{{cite book|url=http://books.google.com/books?id=wh-Xf0WZQlMC&pg=PA11&lpg=PA11&dq=model+parameterization+air+quality+book&source=bl&ots=WjtoJN99qx&sig=eOTBZ0raGDSOcli-A9urQg-RGbM&hl=en&ei=PbdmTfGgIJLVgAedofTLCg&sa=X&oi=book_result&ct=result&resnum=5&ved=0CC8Q6AEwBA#v=onepage&q=model%20parameterization%20air%20quality%20book&f=false|pages=11<U+2013>12|title=Meteorological and Air Quality Models for Urban Areas|author=Baklanov, Alexander, Sue Grimmond, Alexander Mahura|accessdate=2011-02-24|year=2009|publisher=Springer|ISBN=9783642002977}}</ref>

==Domains==
[[File:Sigma-z-coordinates.svg|thumb|280px|A cross-section of the atmosphere over terrain with a sigma-coordinate representation shown. Mesoscale models divide the atmosphere vertically using representations similar to the one shown here.|alt=A sigma coordinate system is shown. The lines of equal sigma values follow the terrain at the bottom, and gradually smoothen towards the top of the atmosphere.]]
The horizontal [[Domain of a function|domain of a model]] is either ''global'', covering the entire Earth, or ''regional'', covering only part of the Earth. Regional models (also known as ''limited-area'' models, or LAMs) allow for the use of finer grid spacing than global models because the available computational resources are focused on a specific area instead of being spread over the globe. This allows regional models to resolve explicitly smaller-scale meteorological phenomena that cannot be represented on the coarser grid of a global model.  Regional models use a global model to specify conditions at the edge of their domain in order to allow systems from outside the regional model domain to move into its area.  Uncertainty and errors within regional models are introduced by the global model used for the boundary conditions of the edge of the regional model, as well as errors attributable to the regional model itself.<ref>{{cite book|url=http://books.google.com/books?id=6RQ3dnjE8lgC&pg=PA261&dq=use+of+ensemble+forecasts+book&hl=en&ei=nqIgTcuJLMX_lgeOn8m8DA&sa=X&oi=book_result&ct=result&resnum=1&ved=0CC4Q6AEwAA#v=onepage&q=use%20of%20ensemble%20forecasts%20book&f=false|title=Numerical Weather and Climate Prediction|author=Warner, Thomas Tomkins |publisher=[[Cambridge University Press]]|year=2010|ISBN=978-0-521-51389-0|page=259|accessdate=2011-02-11}}</ref>

The vertical coordinate is handled in various ways. Lewis Fry Richardson's 1922 model used geometric height (<math>z</math>) as the vertical coordinate. Later models substituted the geometric <math>z</math> coordinate with a pressure coordinate system, in which the [[geopotential height]]s of constant-pressure surfaces become [[dependent variable]]s, greatly simplifying the primitive equations.<ref name="Lynch Ch2">{{cite book|last=Lynch|first=Peter|title=The Emergence of Numerical Weather Prediction|year=2006|publisher=[[Cambridge University Press]]|isbn=978-0-521-85729-1|pages=45<U+2013>46|chapter=The Fundamental Equations}}</ref>  This correlation between coordinate systems can be made since pressure decreases with height through the [[Earth's atmosphere]].<ref>{{cite book|author=Ahrens, C. Donald|page=10|ISBN=978-0-495-11558-8|year=2008|publisher=Cengage Learning|title=Essentials of meteorology: an invitation to the atmosphere|url=http://books.google.com/books?id=2Yn29IFukbgC&pg=PA244&lpg=PA244&dq=regional+weather+forecast+model+characteristics+book&source=bl&ots=iBxiwg0atz&sig=dj58_uKk0k3ef8RxnjbZb76QZ74&hl=en&ei=JyQeTfWZK8H7lweXgYXkCw&sa=X&oi=book_result&ct=result&resnum=6&ved=0CDkQ6AEwBQ#v=onepage&q&f=false|accessdate=2011-02-11}}</ref> The first model used for operational forecasts, the single-layer barotropic model, used a single pressure coordinate at the 500-millibar (about {{convert|5500|m|ft|abbr=on}}) level,<ref name="Charney 1950">{{cite journal|last1=Charney|first1=Jule|last2=Fj<U+00F6>rtoft|first2=Ragnar|last3=von Neumann|first3=John|title=Numerical Integration of the Barotropic Vorticity Equation|journal=Tellus|year=1950|month=November|volume=2|issue=4|doi=10.1111/j.2153-3490.1950.tb00336.x|bibcode=1950Tell....2..237C |url=http://onlinelibrary.wiley.com/doi/10.1111/j.2153-3490.1950.tb00336.x/pdf|accessdate=2011-01-03|authorlink1=Jule Charney|authorlink3=John von Neumann}}</ref> and thus was essentially two-dimensional. High-resolution models<U+2014>also called ''mesoscale models''<U+2014>such as the [[Weather Research and Forecasting model]] tend to use normalized pressure coordinates referred to as ''sigma coordinates''.<ref>{{cite web|last=Janjic  |first=Zavisa|title=Scientific Documentation for the NMM Solver|url=http://nldr.library.ucar.edu/collections/technotes/asset-000-000-000-845.pdf|publisher=[[National Center for Atmospheric Research]]|accessdate=2011-01-03|coauthors=Gall, Robert; Pyle, Matthew E.|pages=12<U+2013>13|month=February|year=2010}}</ref>  This coordinate system receives its name from the [[independent variable]] <math>\sigma</math> used to [[nondimensionalization|scale]] atmospheric pressures with respect to the pressure at the surface, and in some cases also with the pressure at the top of the domain.<ref>{{cite book|last=Pielke|first=Roger A.|title=Mesoscale Meteorological Modeling|year=2002|publisher=[[Academic Press]]|isbn=0-12-554766-8|pages=131<U+2013>132|accessdate=2011-01-02}}</ref>

==Model output statistics==
{{Main|Model output statistics}}
Because forecast models based upon the equations for atmospheric dynamics do not perfectly determine weather conditions, statistical methods have been developed to attempt to correct the forecasts.  Statistical models were created based upon the three-dimensional fields produced by numerical weather models, surface observations and the climatological conditions for specific locations.  These statistical models are collectively referred to as [[model output statistics]] (MOS),<ref>{{cite book|url=http://books.google.com/books?id=blEMoIKX_0IC&pg=PA188#v=onepage&q&f=false|page=189|title=When nature strikes: weather disasters and the law|author=Baum, Marsha L.|publisher=Greenwood Publishing Group|year=2007|ISBN=978-0-275-22129-4|accessdate=2011-02-11}}</ref> and were developed by the [[National Weather Service]] for their suite of weather forecasting models in the late 1960s.<ref name="MOS">{{cite book|title=Model output statistics forecast guidance|first=Harry | last=Hughes|publisher=United States Air Force Environmental Technical Applications Center|year=1976|pages=1<U+2013>16}}</ref><ref>{{cite journal|last=Glahn|first=Harry R.|coauthors=Lowry, Dale A.|title=The Use of Model Output Statistics (MOS) in Objective Weather Forecasting|journal=[[Journal of Applied Meteorology]]|year=1972|month=December|volume=11|issue=8|pages=1203<U+2013>1211|doi=10.1175/1520-0450(1972)011<1203:TUOMOS>2.0.CO;2|bibcode=1972JApMe..11.1203G}}</ref> 

Model output statistics differ from the ''perfect prog'' technique, which assumes that the output of numerical weather prediction guidance is perfect.<ref>{{cite book|url=http://books.google.com/books?id=QwzHZ-wV-BAC&pg=PA1144|page=1144|title=Fog and boundary layer clouds: fog visibility and forecasting|author=Gultepe, Ismail|publisher=Springer|year=2007|ISBN=9783764384180|accessdate=2011-02-11}}</ref>  MOS can correct for local effects that cannot be resolved by the model due to insufficient grid resolution, as well as model biases.  Because MOS is run after its respective global or regional model, its production is known as post-processing.  Forecast parameters within MOS include maximum and minimum temperatures, percentage chance of rain within a several hour period, precipitation amount expected, chance that the precipitation will be frozen in nature, chance for thunderstorms, cloudiness and surface winds.<ref>{{cite book|url=http://books.google.com/books?id=Xs9LiGpNX-AC&pg=PA171|page=172|author=Barry, Roger Graham; Chorley, Richard J. |title=Atmosphere, weather, and climate|publisher=Psychology Press|year=2003|accessdate=2011-02-11|ISBN=978-0-415-27171-4}}</ref>

==Ensembles==
{{main|Ensemble forecasting}}
[[File:WRF rita spread2.jpg|thumb|280px|''Top'': [[Weather Research and Forecasting model]] (WRF) simulation of [[Hurricane Rita]] tracks. ''Bottom'': The spread of NHC multi-model ensemble forecast.|alt=Two images are shown. The top image provides three potential tracks that could have been taken by Hurricane Rita. Contours over the coast of Texas correspond to the sea-level air pressure predicted as the storm passed. The bottom image shows an ensemble of track forecasts produced by different weather models for the same hurricane.]]
In 1963, [[Edward Lorenz]] discovered the [[chaos theory|chaotic nature]] of the [[fluid dynamics]] equations involved in weather forecasting.<ref name="Cox">{{cite book|title=Storm Watchers|pages=222<U+2013>224|year=2002|author=Cox, John D.|publisher=John Wiley & Sons, Inc.|ISBN=0-471-38108-X}}</ref>   Extremely small errors in temperature, winds, or other initial inputs given to numerical models will amplify and double every five days,<ref name="Cox" /> making it impossible for long-range forecasts<U+2014>those made more than two weeks in advance<U+2014>to predict the state of the atmosphere with any degree of [[forecast skill]].  Furthermore, existing observation networks have poor coverage in some regions (for example, over large bodies of water such as the Pacific Ocean), which introduces uncertainty into the true initial state of the atmosphere.  While a set of equations, known as the [[Liouville's theorem (Hamiltonian)|Liouville equations]], exists to determine the initial uncertainty in the model initialization, the equations are too complex to run in real-time, even with the use of supercomputers.<ref name="HPCens"/>  These uncertainties limit forecast model accuracy to about six days into the future.<ref name="Klaus">{{cite web|last=Weickmann|first=Klaus|coauthors=Jeff Whitaker; Andres Roubicek; Catherine Smith |date=2001-12-01 | url=http://www.esrl.noaa.gov/psd/spotlight/12012001/ | title = The Use of Ensemble Forecasts to Produce Improved Medium Range (3<U+2013>15&nbsp;days) Weather Forecasts. | publisher=[[Climate Diagnostics Center]] | accessdate=2007-02-16}}</ref>  

[[Edward Epstein]] recognized in 1969 that the atmosphere could not be completely described with a single forecast run due to inherent uncertainty, and proposed using an [[Ensemble (fluid mechanics)|ensemble]] of [[stochastic process|stochastic]] [[Monte Carlo method|Monte Carlo simulations]] to produce [[arithmetic mean|means]] and [[variance]]s for the state of the atmosphere.<ref>{{cite journal|last=Epstein|first=E.S.|title=Stochastic dynamic prediction|journal=[[Tellus]]|year=1969|month=December|volume=21|issue=6|pages=739<U+2013>759|doi=10.1111/j.2153-3490.1969.tb00483.x|bibcode=1969Tell...21..739E|accessdate=2011-01-03}}</ref> Although this early example of an ensemble showed skill, in 1974 [[Cecil Leith]] showed that they produced adequate forecasts only when the ensemble [[probability distribution]] was a representative sample of the probability distribution in the atmosphere.<ref>{{cite journal|last=Leith|first=C.E.|title=Theoretical Skill of Monte Carlo Forecasts|journal=[[Monthly Weather Review]]|year=1974|month=June|volume=102|issue=6|pages=409<U+2013>418|url=http://journals.ametsoc.org/doi/pdf/10.1175/1520-0493%281974%29102%3C0409%3ATSOMCF%3E2.0.CO%3B2|doi=10.1175/1520-0493(1974)102<0409:TSOMCF>2.0.CO;2|bibcode=1974MWRv..102..409L|accessdate=2011-01-03}}</ref>  

Since the 1990s, ''ensemble forecasts'' have been used operationally (as routine forecasts) to account for the stochastic nature of weather processes &ndash; that is, to resolve their inherent uncertainty.  This method involves analyzing multiple forecasts created with an individual forecast model by using different physical [[parametrization (climate)|parametrizations]] or varying initial conditions.<ref name="HPCens">{{cite web|url=http://www.hpc.ncep.noaa.gov/ensembletraining|author=Manousos, Peter|publisher=[[Hydrometeorological Prediction Center]]|date=2006-07-19|accessdate=2010-12-31|title=Ensemble Prediction Systems}}</ref> Starting in 1992 with [[Ensemble forecasting|ensemble forecasts]] prepared by the [[European Centre for Medium-Range Weather Forecasts]] (ECMWF) and the [[National Centers for Environmental Prediction]], model ensemble forecasts have been used to help define the forecast uncertainty and to extend the window in which numerical weather forecasting is viable farther into the future than otherwise possible.<ref name="Toth"/><ref name="ECens"/><ref name="RMS"/> The ECMWF model, the Ensemble Prediction System,<ref name="ECens">{{cite web | url=http://www.ecmwf.int/products/forecasts/guide/The_Ensemble_Prediction_System_EPS_1.html | title=The Ensemble Prediction System (EPS) | publisher=[[ECMWF]] | accessdate=2011-01-05}}</ref> uses [[Singular value decomposition|singular vectors]] to simulate the initial [[probability density function|probability density]], while the NCEP ensemble, the Global Ensemble Forecasting System, uses a technique known as [[Bred vector|vector breeding]].<ref name="Toth">{{cite journal|last=Toth|first=Zoltan|coauthors=Kalnay, Eugenia|title=Ensemble Forecasting at NCEP and the Breeding Method |journal=[[Monthly Weather Review]]|year=1997|month=December|volume=125|issue=12|pages=3297<U+2013>3319|url=http://journals.ametsoc.org/doi/pdf/10.1175/1520-0493%281997%29125%3C3297%3AEFANAT%3E2.0.CO%3B2|doi=10.1175/1520-0493(1997)125<3297:EFANAT>2.0.CO;2|bibcode=1997MWRv..125.3297T|accessdate=2011-01-03}}</ref><ref name="RMS">{{cite journal|title=The ECMWF Ensemble Prediction System: Methodology and validation|journal=Quarterly Journal of the [[Royal Meteorological Society]]|year=1996|month=January|volume=122|issue=529|pages=73<U+2013>119|url=http://onlinelibrary.wiley.com/doi/10.1002/qj.49712252905/pdf|doi=10.1002/qj.49712252905|bibcode=1996QJRMS.122...73M|accessdate=2010-01-03|author=Molteni, F.; Buizza, R.; Palmer, T.N.; Petroliagis, T.}}</ref>

In a single model-based approach, the ensemble forecast is usually evaluated in terms of an average of the individual forecasts concerning one forecast variable, as well as the degree of agreement between various forecasts within the ensemble system, as represented by their overall spread.  Ensemble spread is diagnosed through tools such as [[spaghetti plot|spaghetti diagrams]], which show the dispersion of one quantity on prognostic charts for specific time steps in the future.  Another tool where ensemble spread is used is a [[meteogram]], which shows the dispersion in the forecast of one quantity for one specific location.  It is common for the ensemble spread to be too small to include the weather that actually occurs, which can lead to forecasters misdiagnosing model uncertainty;<ref name="ensbook"/> this problem becomes particularly severe for forecasts of the weather about ten days in advance.<ref>{{cite journal|last=Palmer|first=T.N.|coauthors=G.J. Shutts, R. Hagedorn, F.J. Doblas-Reyes, T. Jung, and M. Leutbecher|title=Representing Model Uncertainty in Weather and Climate Prediction|journal=[[Annual Review of Earth and Planetary Sciences]]|year=2005|month=May|volume=33|pages=163<U+2013>193|doi=10.1146/annurev.earth.33.092203.122552|bibcode=2005AREPS..33..163P|url=http://www.annualreviews.org/doi/pdf/10.1146/annurev.earth.33.092203.122552|accessdate=2011-02-09}}</ref> When ensemble spread is small and the forecast solutions are consistent within multiple model runs, forecasters perceive more confidence in the ensemble mean, and the forecast in general.<ref name="ensbook">{{cite book|url=http://books.google.com/books?id=6RQ3dnjE8lgC&pg=PA261#v=onepage&q&f=false|title=Numerical Weather and Climate Prediction|author=Warner, Thomas Tomkins |publisher=[[Cambridge University Press]]|year=2010|ISBN=978-0-521-51389-0|pages=266<U+2013>275|accessdate=2011-02-11}}</ref>  Despite this perception, a ''spread-skill relationship'' is often weak or not found, as spread-error [[Correlation and dependence#Correlation and linearity|correlations]] are normally less than 0.6, and only under special circumstances range between 0.6&ndash;0.7.<ref>{{cite web|url=http://www.atmos.washington.edu/~ens/pdf/WEM_WKSHP_2004.epgrimit.pdf|title=Redefining the Ensemble Spread-Skill Relationship from a Probabilistic Perspective|author=Grimit, Eric P.; Mass, Clifford F. |publisher=[[University of Washington]]|date=October 2004|accessdate=2010-01-02}}</ref>  The relationship between ensemble spread and [[forecast skill]] varies substantially depending on such factors as the forecast model and the region for which the forecast is made.

In the same way that many forecasts from a single model can be used to form an ensemble, multiple models may also be combined to produce an ensemble forecast. This approach is called ''multi-model ensemble forecasting'', and it has been shown to improve forecasts when compared to a single model-based approach.<ref>{{cite journal|url=http://www.emc.ncep.noaa.gov/mmb/SREF/2222289_WAF_Feb-2010.official.PDF|title=Fog Prediction From a Multimodel Mesoscale Ensemble Prediction System|author=Zhou, Binbin; Du, Jun |volume=25|date=February 2010|accessdate=2011-01-02|journal=[[Weather and Forecasting]]|publisher=[[American Meteorological Society]]|page=303|doi=10.1175/2009WAF2222289.1|bibcode=2010WtFor..25..303Z}}</ref>  Models within a multi-model ensemble can be adjusted for their various biases, which is a process known as ''superensemble forecasting''.  This type of forecast significantly reduces errors in model output.<ref>{{cite journal|url=http://www.nat-hazards-earth-syst-sci.net/10/265/2010/nhess-10-265-2010.pdf|title=Multimodel SuperEnsemble technique for quantitative precipitation forecasts in Piemonte region|author=Cane, D.; Milelli, M.|date=2010-02-12|accessdate=2011-01-02|journal=Natural Hazards and Earth System Sciences|doi=10.5194/nhess-10-265-2010|bibcode=2010NHESS..10..265C|volume=10|page=265}}</ref>

== Applications ==
===Air quality modeling===
{{see also|Atmospheric dispersion modeling}}
[[Air quality]] forecasting attempts to predict when the concentrations of pollutants will attain levels that are hazardous to public health.  The concentration of pollutants in the atmosphere is determined by their ''transport'', or [[Arithmetic mean|mean]] velocity of movement through the atmosphere, their [[diffusion]], [[chemical transformation]], and ground [[Deposition (aerosol physics)|deposition]].<ref>{{cite book|url=http://www.envirocomp.org/books/chapters/2aap.pdf|page=16|title=Chapter 2: Air Pollution Modeling <U+2013> An Overview|author=Daly, Aaron and Paolo Zannetti|title=Ambient Air Pollution|publisher=The Arab School for Science and Technology and The EnviroComp Institute|year=2007|accessdate=2011-02-24}}</ref>  In addition to pollutant source and terrain information, these models require data about the state of the [[fluid flow]] in the atmosphere to determine its transport and diffusion.<ref name="Baklanov">{{cite journal|last=Baklanov|first=Alexander|coauthors=Rasmussen, Alix; Fay, Barbara; Berge, Erik; Finardi, Sandro |title=Potential and Shortcomings of Numerical Weather Prediction Models in Providing Meteorological Data for Urban Air Pollution Forecasting|journal=Water, Air and Soil Pollution: Focus|year=2002|month=September|volume=2|issue=5|pages=43<U+2013>60|doi=10.1023/A:1021394126149|accessdate=2011-02-13}}</ref>  Meteorological conditions such as [[thermal inversion]]s can prevent surface air from rising, trapping pollutants near the surface,<ref>{{cite book|last=Marshall|first=John|title=Atmosphere, ocean, and climate dynamics: an introductory text|year=2008|publisher=Elsevier Academic Press|location=Amsterdam|isbn=978-0-12-558691-7|pages=44<U+2013>46|coauthors=Plumb, R. Alan}}</ref> which makes accurate forecasts of such events crucial for air quality modeling. Urban air quality models require a very fine computational mesh, requiring the use of high-resolution mesoscale weather models; in spite of this, the quality of numerical weather guidance is the main uncertainty in air quality forecasts.<ref name="Baklanov"/>

===Climate modeling===
{{See also|Global climate model}}
A General Circulation Model (GCM) is a [[mathematical model]] that can be used in computer simulations of the general circulation of a planetary [[atmosphere]] or ocean.  An atmospheric general circulation model (AGCM) is essentially the same as a global numerical weather prediction model, and some (such as the one used in the UK Unified Model) can be configured for both short-term weather forecasts and longer-term climate predictions.  Along with [[sea ice]] and land-surface components, AGCMs and oceanic GCMs (OGCM) are key components of global climate models, and are widely applied for understanding the [[climate]] and projecting [[climate change]].  For example, they can be used to simulate the [[El Ni<U+00F1>o-Southern Oscillation]] and study its [[Forcing function (differential equations)|forcings]] on global climate and the Asian monsoon circulation.  For aspects of climate change, a range of man-made chemical emission scenarios can be fed into the climate models to see how an enhanced [[greenhouse effect]] would modify the Earth's climate.<ref>{{cite book|url=http://books.google.com/books?id=Pzx_Nz1qgd8C&pg=PA40|author=Australian Bureau of Statistics|title=Year book, Australia, Issue 87|page=40|year=2005|accessdate=2011-02-18}}</ref>  Versions designed for climate applications with time scales of decades to centuries were originally created in 1969 by [[Syukuro Manabe]] and [[Kirk Bryan (oceanographer)|Kirk Bryan]] at the [[Geophysical Fluid Dynamics Laboratory]] in [[Princeton, New Jersey]].<ref>{{cite web |url=http://celebrating200years.noaa.gov/breakthroughs/climate_model/welcome.html |title=The First Climate Model |author=[[National Oceanic and Atmospheric Administration]] 200th Celebration |publisher=[[National Oceanic and Atmospheric Administration]]|date=2008-05-22 |accessdate=2010-04-20 }}</ref>  When run for multiple decades, the models use a low resolution, which leaves smaller-scale interactions unresolved.<ref>{{cite book|url=http://books.google.com/books?id=bV3C5VCC-0EC&pg=PA282|pages=284<U+2013>289|title=The global climate system: patterns, processes, and teleconnections|author=Bridgman, Howard A., John E. Oliver, Michael H. Glantz|year=2006|publisher=Cambridge University Press|ISBN=978-0-521-82642-6|accessdate=2011-02-18}}</ref>

===Ocean surface modeling===
[[File:NOAA Wavewatch III Sample Forecast.gif|right|thumb|280px|NOAA Wavewatch III 120-hour wind and wave forecast for the North Atlantic|alt=A wind and wave forecast for the North Atlantic ocean. Two areas of high waves are identified: One west of the southern tip of Greenland, and the other in the North Sea. Calm seas are forecast for the Gulf of Mexico. Wind barbs show the expected wind strengths and directions at regularly-spaced intervals over the North Atlantic.]]
{{main|Ocean dynamics|Wind wave model}}
The transfer of energy between the wind blowing over the surface of an ocean and the ocean's upper layer is an important element in wave dynamics.<ref>{{cite journal|last=Chalikov|first=D. V.|title=The numerical simulation of wind-wave interaction|journal=[[Journal of Fluid Mechanics]]|year=1978|month=August|volume=87|issue=3|pages=561<U+2013>82|doi=10.1017/S0022112078001767|bibcode=1978JFM....87..561C|accessdate=2011-02-13}}</ref>  The [[spectral wave transport equation]] is used to describe the change in wave spectrum over changing topography.  It simulates wave generation, wave movement (propagation within a fluid), [[wave shoaling]], [[refraction]], energy transfer between waves, and wave dissipation.<ref>{{cite book|page=270|url=http://books.google.com/books?id=yBtOwfUG6cgC&printsec=frontcover&dq=spectral+wave+transport+equation&source=bl&ots=0E3XUBFqXe&sig=lKdQJ3MIF0I_ztu9ASjgoQwmoA4&hl=en&ei=zNRnTeTrPIbfgQfFmfDLCg&sa=X&oi=book_result&ct=result&resnum=4&sqi=2&ved=0CC0Q6AEwAw#v=onepage&q=wave%20spectral%20transport%20equation&f=false|title=Numerical modeling of water waves|author=Lin, Pengzhi|publisher=Psychology Press|year=2008|ISBN=9780415415781}}</ref>  Since surface winds are the primary forcing mechanism in the spectral wave transport equation, ocean wave models use information produced by numerical weather prediction models as inputs to determine how much energy is transferred from the atmosphere into the layer at the surface of the ocean. Along with dissipation of energy through [[Wind wave|whitecaps]] and [[resonance]] between waves, surface winds from numerical weather models allow for more accurate predictions of the state of the sea surface.<ref>{{cite journal|last=Bender|first=Leslie C.|title=Modification of the Physics and Numerics in a Third-Generation Ocean Wave Model|journal=[[Journal of Atmospheric and Oceanic Technology]]|year=1996|month=January|volume=13|issue=3|pages=726|doi=10.1175/1520-0426(1996)013<0726:MOTPAN>2.0.CO;2|bibcode=1996JAtOT..13..726B}}</ref>

===Tropical cyclone forecasting===
{{see also|Tropical cyclone forecast model}}
Tropical cyclone forecasting also relies on data provided by numerical weather models. Three main classes of [[Tropical cyclone forecast model|tropical cyclone guidance models]] exist: Statistical models are based on an analysis of storm behavior using climatology, and correlate a storm's position and date to produce a forecast that is not based on the physics of the atmosphere at the time. Dynamical models are numerical models that solve the governing equations of fluid flow in the atmosphere; they are based on the same principles as other limited-area numerical weather prediction models but may include special computational techniques such as refined spatial domains that move along with the cyclone. Models that use elements of both approaches are called statistical-dynamical models.<ref>{{cite web|title=Technical Summary of the National Hurricane Center Track and Intensity Models|url=http://www.nhc.noaa.gov/pdf/model_summary_20090724.pdf|publisher=National Oceanic and Atmospheric Administration|accessdate=2011-02-19|author=[[National Hurricane Center]]|month=July|year=2009}}</ref>

In 1978, the first [[tropical cyclone forecast model|hurricane-tracking model]] based on [[Atmospheric dynamics#Dynamic meteorology|atmospheric dynamics]]<U+2014>the movable fine-mesh (MFM) model<U+2014>began operating.<ref name="Shuman W&F"/>  Within the field of [[tropical cyclone track forecasting]], despite the ever-improving dynamical model guidance which occurred with increased computational power, it was not until the 1980s when numerical weather prediction showed [[Forecast skill|skill]], and until the 1990s when it consistently outperformed [[statistical model|statistical]] or simple dynamical models.<ref>{{cite web|url=http://www.nhc.noaa.gov/verification/verify6.shtml|publisher=[[National Hurricane Center]]|date=2010-04-20|accessdate=2011-01-02|author=[[James Franklin (meteorologist)|Franklin, James]]|title=National Hurricane Center Forecast Verification}}</ref> Predictions of the intensity of a tropical cyclone based on numerical weather prediction continue to be a challenge, since statistical methods continue to show higher skill over dynamical guidance.<ref>{{cite journal|last=Rappaport|first=Edward N.|coauthors=Franklin, James L.; Avila, Lixion A.; Baig, Stephen R.; Beven II, John L.; Blake, Eric S.; Burr, Christopher A.; Jiing, Jiann-Gwo; Juckins, Christopher A.; Knabb, Richard D.; Landsea, Christopher W.; Mainelli, Michelle; Mayfield, Max; McAdie, Colin J.; Pasch, Richard J.; Sisko, Christopher; Stewart, Stacy R.; Tribble, Ahsha N.|title=Advances and Challenges at the National Hurricane Center|journal=[[Weather and Forecasting]]|year=2009|month=April|volume=24|issue=2|pages=395<U+2013>419|doi=10.1175/2008WAF2222128.1|bibcode=2009WtFor..24..395R}}</ref>

===Wildfire modeling===
{{See also|Wildfire modeling}}
[[File:Propagation model wildfire.png|thumb|280px|right|A simple wildfire propagation model]]
On a molecular scale, there are two main competing reaction processes involved in the degradation of [[cellulose]], or wood fuels, in [[wildfire]]s.  When there is a low amount of moisture in a cellulose fiber, [[volatilization]] of the fuel occurs; this process will generate intermediate gaseous products that will ultimately be the source of [[combustion]].  When moisture is present<U+2014>or when enough heat is being carried away from the fiber, [[charring]] occurs. The [[chemical kinetics]] of both reactions indicate that there is a point at which the level of moisture is low enough<U+2014>and/or heating rates high enough<U+2014>for combustion processes become self-sufficient. Consequently, changes in wind speed, direction, moisture, temperature, or [[lapse rate]] at different levels of the atmosphere can have a significant impact on the behavior and growth of a wildfire. Since the wildfire acts as a heat source to the atmospheric flow, the wildfire can modify local [[advection]] patterns, introducing a [[Feedback|feedback loop]] between the fire and the atmosphere.<ref name="Sullivan wildfire">{{cite journal|last=Sullivan|first=Andrew L.|title=Wildland surface fire spread modelling, 1990<U+2013>2007. 1: Physical and quasi-physical models|journal=International Journal of Wildland Fire|year=2009|month=June|volume=18|issue=4|pages=349|doi=10.1071/WF06143|arxiv=0706.3074}}</ref> 

A simplified two-dimensional model for the spread of wildfires that used [[convection]] to represent the effects of wind and terrain, as well as [[Thermal radiation|radiative heat transfer]] as the dominant method of heat transport led to [[reaction-diffusion system]]s of [[partial differential equation]]s.<ref name="Asensio-2002-WFM">{{cite journal|author=Asensio, M. I.  and L. Ferragut|title=On a wildland fire model with radiation|journal=International Journal for Numerical Methods in Engineering|volume=54|pages=137<U+2013>157|year=2002|doi=10.1002/nme.420}}</ref><ref name="Mandel-2008-WMD">{{cite journal|author=Mandel, Jan, Lynn S. Bennethum, Jonathan D. Beezley, Janice L. Coen, Craig C. Douglas, Minjeong Kim, and Anthony Vodacek|title=A wildfire model with data assimilation|journal=Mathematics and Computers in Simulation|volume=79|pages=584<U+2013>606|year=2008|doi=10.1016/j.matcom.2008.03.015|arxiv=0709.0086|bibcode=2007arXiv0709.0086M}}</ref> More complex models join numerical weather models or [[computational fluid dynamics]] models with a wildfire component which allow the feedback effects between the fire and the atmosphere to be estimated.<ref name="Sullivan wildfire"/>  The additional complexity in the latter class of models translates to a corresponding increase in their computer power requirements. In fact, a full three-dimensional treatment of [[combustion]] via [[direct numerical simulation]] at scales relevant for atmospheric modeling is not currently practical because of the excessive computational cost such a simulation would require.  Numerical weather models have limited forecast skill at spatial resolutions under {{convert|1|km|mi|1|sp=us}}, forcing complex wildfire models to parameterize the fire in order to calculate how the winds will be modified locally by the wildfire, and to use those modified winds to determine the rate at which the fire will spread locally.<ref name="Clark-1996-CAFb">{{cite journal|author=Clark, T. L., M. A. Jenkins, J. Coen, and David Packham|title=A coupled atmospheric-fire model: Convective Froude number and dynamic fingering|journal=International Journal of Wildland Fire|volume=6|pages=177<U+2013>190|year=1996|doi=10.1071/WF9960177}}</ref><ref name="Clark-1996-CAF">{{cite journal|author=Clark, Terry L., Marry Ann Jenkins, Janice Coen, and David Packham|title=A coupled atmospheric-fire model: Convective feedback on fire line dynamics|journal=Journal of Applied Meteorology|volume=35|pages=875<U+2013>901|year=1996|doi=10.1175/1520-0450(1996)035<0875:ACAMCF>2.0.CO;2|bibcode=1996JApMe..35..875C}}</ref><ref name="Rothermel-1972-MMP">{{cite web|author=Rothermel, Richard C.|title=A mathematical model for predicting fire spread in wildland fires|publisher=[[United States Forest Service]]|month=January|year=1972|url=http://www.fs.fed.us/rm/pubs_int/int_rp115.pdf|accessdate=2011-02-28}}</ref>  Although models such as [[Los Alamos National Laboratory|Los Alamos]]' FIRETEC solve for the concentrations of fuel and [[oxygen]], the computational grid cannot be fine enough to resolve the combustion reaction, so approximations must be made for the temperature distribution within each grid cell, as well as for the combustion reaction rates themselves.

== See also ==
* [[Atmospheric physics]]
* [[Atmospheric thermodynamics]]
* [[Tropical cyclone forecast model]]
* [[Atmospheric_model#Types|Types of atmospheric models]]

== References ==
{{reflist|2}}

==Further reading==
<div class="references-small">
*Beniston, Martin. ''From Turbulence to Climate: Numerical Investigations of the Atmosphere with a Hierarchy of Models''. Berlin: Springer, 1998.
*Kalnay, Eugenia. ''Atmospheric Modeling, Data Assimilation and Predictability''. Cambridge University Press, 2003.
*Thompson, Philip. ''Numerical Weather Analysis and Prediction''. New York: The Macmillan Company, 1961.
*U.S. Department of Commerce, National Oceanic and Atmospheric Administration, National Weather Service. ''National Weather Service Handbook No. 1 <U+2013> Facsimile Products''. Washington, DC: Department of Commerce, 1979.
</div>

==External links==
* [http://www.noaanews.noaa.gov/stories2005/s2387.htm NOAA Supercomputers]
* [http://www.arl.noaa.gov/ready/cmet.html Air Resources Laboratory]
* [https://www.fnmoc.navy.mil/PUBLIC/ Fleet Numerical Meteorology and Oceanography Center]
* [http://www.ecmwf.int/ European Centre for Medium-Range Weather Forecasts]
{{Atmospheric, Oceanographic and Climate Models}}

{{featured article}}
{{DEFAULTSORT:Numerical Weather Prediction}}
[[Category:Weather prediction]]
[[Category:Numerical climate and weather models]]
[[Category:Computational science]]
[[Category:Mathematical science occupations]]

[[ca:Model num<U+00E8>ric de predicci<U+00F3> meteorol<U+00F2>gica]]
[[de:Numerische Wettervorhersage]]
[[es:Modelo num<U+00E9>rico de predicci<U+00F3>n meteorol<U+00F3>gica]]
[[eo:Cifereca veterprognozo]]
[[fr:Pr<U+00E9>vision num<U+00E9>rique du temps]]
[[it:Modelli numerici di previsione meteorologica]]
[[hu:Numerikus id<U+0151>j<U+00E1>r<U+00E1>s-el<U+0151>rejelz<U+00E9>s]]
[[ja:<U+6570><U+5024><U+4E88><U+5831>]]
[[no:Numerisk v<U+00E6>rvarsling]]
[[nn:Numerisk v<U+00EA>rvarsling]]
[[pl:Numeryczna prognoza pogody]]
[[pt:Previs<U+00E3>o num<U+00E9>rica do tempo]]
[[ru:<U+0427><U+0438><U+0441><U+043B><U+0435><U+043D><U+043D><U+044B><U+0439> <U+043F><U+0440><U+043E><U+0433><U+043D><U+043E><U+0437> <U+043F><U+043E><U+0433><U+043E><U+0434><U+044B>]]
[[simple:Numerical weather prediction]]
[[fi:Numeerinen s<U+00E4><U+00E4>nennustaminen]]
[[zh:<U+5929><U+6C23><U+6578><U+503C><U+9810><U+6E2C>]]
