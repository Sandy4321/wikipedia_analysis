[[Image:BuretteCloseup.jpg|thumb|right|200px|Apparatus for carrying out acid-base titration. Acid-base reactions are the most important application of equilibrium chemistry.]]
In a [[chemical process]], '''chemical equilibrium''' is the state in which the [[Activity (chemistry)|chemical activities]] or [[concentrations]] of the reactants and products have no net change over time.  Usually, this state results when the forward [[chemical process]] proceeds at the same rate as their [[Reversible reaction|reverse reaction]]. The [[reaction rate]]s of the forward and reverse reactions are generally not zero but, being equal, there are no net changes in any of the reactant or product concentrations.  This process is known as [[dynamic equilibrium]] <ref>Atkins & Jones, 2001</ref> <ref>[[Gold Book]] definition [http://goldbook.iupac.org/C01023.html Link]</ref>

{{Chemical equilibria}}

== Introduction ==
In a [[chemical reaction]], when reactants are mixed together in a reaction vessel (and heated if needed), the whole of reactants do not get converted into the products. After some time (which may be shorter than millionths of a second or longer than the age of the universe), there will come a point when a fixed amount of reactants will exist in harmony with a fixed amount of products, the amounts of neither changing anymore. This is called chemical equilibrium. 

The concept of chemical equilibrium was developed after [[Berthollet]] (1803) found that some [[chemical reaction]]s are [[Reversible reaction|reversible]]. For any reaction such as

:<math> \alpha A + \beta B \rightleftharpoons \sigma S + \tau T</math> 

to be at equilibrium the [[reaction rate|rates]] of the forward and  backward (reverse) reactions have to be equal. In this [[chemical equation]] with harpoon arrows pointing both ways to indicate equilibrium, A and B are [[reactant]] chemical species, S and T are product species, and [[alpha|<U+03B1>]], [[beta|<U+03B2>]], [[sigma|<U+03C3>]], and [[tau|<U+03C4>]] are the [[stoichiometric coefficient]]s of the respective reactants and products. The equilibrium position of a reaction is said to lie far to the right if, at equilibrium, nearly all the reactants are used up and far to the left if hardly any product is formed from the reactants.

[[Cato Maximilian Guldberg|Guldberg ]] and [[Peter Waage|Waage]] (1865), building on Berthollet<U+2019>s ideas, proposed the law of [[mass action]]:
 
:<math>\mbox{forward reaction rate} = k_+ {A}^\alpha{B}^\beta \,\!</math>
:<math>\mbox{backward reaction rate} = k_{-} {S}^\sigma{T}^\tau \,\!</math>

where A, B, S and T are [[activity (chemistry)|active masses]] and k<sub>+</sub> and k<sub><U+2212></sub> are [[rate constant]]s. Since forward and backward rates are equal:

:<math> k_+ {A}^\alpha{B}^\beta  = k_{-} {S}^\sigma{T}^\tau \,</math>

and the ratio of the rate constants is also a constant, now known as an [[equilibrium constant]].
:<math>K=\frac{k_+}{k_-}=\frac{\{S\}^\sigma \{T\}^\tau } {\{A\}^\alpha \{B\}^\beta}</math>

By convention the products form the [[numerator]]. 
Unfortunately, the law of [[mass action]] is valid only for concerted one-step reactions that proceed through a single [[transition state]] and is '''not valid in general''' because [[reaction rate#rate equation|rate equations]] do not in general follow the [[stoichiometry]] of the reaction as Guldberg and Waage had proposed (see, for example, [[nucleophilic aliphatic substitution]] by SN1 or reaction of [[hydrogen]] and [[bromine]] to form [[hydrogen bromide]]). Equality of forward and backward reaction rates, however, is a [[Necessary and sufficient conditions|necessary condition]] for chemical equilibrium, though it is not [[Necessary and sufficient conditions|sufficient]] to explain why equilibrium occurs.

Despite the failure of this derivation, the equilibrium constant for a reaction is indeed a constant, independent of the activities of the various species involved, though it does depend on temperature as observed by the [[Van't Hoff equation]]. Adding a [[catalyst]] will affect both the forward reaction and the reverse reaction in the same way and will not have an effect on the equilibrium constant. The catalyst will speed up both reactions thereby increasing the speed at which equilibrium is reached <ref>''Chemistry: Matter and Its Changes'' James E. Brady , Fred Senese 4th Ed. ISBN 0471215171</ref> <ref>''Chemical Principles: The Quest for Insight'' Peter Atkins, Loretta Jones 2nd Ed. ISBN 0716757010 </ref>.  

Although the macroscopic equilibrium concentrations are constant in time reactions do occur at the molecular level. For example, in the case of [[ethanoic acid]] dissolved in water and forming [[ethanoate]] and [[hydronium]] ions,
:CH<sub>3</sub>CO<sub>2</sub>H + H<sub>2</sub>O {{unicode|<U+21CC>}} CH<sub>3</sub>CO<sub>2</sub><sup><U+2212></sup> + H<sub>3</sub>O<sup>+</sup>
a proton may hop from one molecule of  ethanoic acid on to a water molecule and then on to an ethanoate ion to form another molecule of ethanoic acid and leaving the number of ethanoic acid molecules unchanged. This is an example of [[dynamic equilibrium]]. Equilibriums, like the rest of thermodynamics, are statistical phenomena, averages of microscopic behaviour.

[[Le Chatelier's principle]] (1884) is a useful principle that gives a qualitative idea of an equilibrium system's response to changes in reaction conditions.  ''If a dynamic equilibrium is disturbed by changing the conditions, the position of equilibrium moves to counteract the change''.  For example, adding more S from the outside will cause an excess of products and the system will try to counteract this by increasing the reverse reaction and pushing the equilibrium point backward (though the equilibrium constant will stay the same). 

If [[mineral acid]] is added to the ethanoic acid mixture, increasing the concentration of hydronium ion, the amount of dissociation must decrease as the reaction is driven to the left in accordance with this principle. This can also be deduced from the equilibrium constant expression for the reaction:
:<math>K=\frac{\{CH_3CO_2^-\}\{H_3O^+\}} {\{CH_3CO_2H\}\{H_2O \}}</math>
if {H<sub>3</sub>O<sup>+</sup>} increases {CH<sub>3</sub>CO<sub>2</sub>H} must increase and {CH<sub>3</sub>CO<sub>2</sub><sup><U+2212></sup>} must decrease.

A quantitative version is given by the [[reaction quotient]].

[[J.W. Gibbs]] suggested in 1873 that equilibrium is attained when the [[chemical potential|Gibbs energy]] of the system is at its minimum value (assuming the reaction is carried out under constant pressure). What this means is, the derivative of the Gibbs energy with respect to [[reaction coordinate]] (a measure of the [[extent of reaction]] that has occurred, ranging from zero for all reactants to a maximum for all products) vanishes, signalling a [[stationary point]]. This derivative is usually called, for certain technical reasons, the Gibbs energy change<ref>Physical Chemistry by Atkins, De Paula</ref>. This criterion is both necessary and sufficient. If a mixture is not at equilibrium the liberation of the excess Gibbs energy (or [[Helmholtz energy]] at constant volume reactions) is the <U+201C>driving force<U+201D> for the composition of the mixture to change until equilibrium is reached. The equilibrium constant can be related to the standard [[Gibbs energy]] change for the reaction by the equation

:<math>
\Delta G^\ominus = -RT \ln K_{eq} 
</math>

where R is the [[universal gas constant]] and T the [[temperature]].

When the reactants are [[solution|dissolved]] in a medium of high [[ionic strength]] the quotient of [[activity coefficient]]s  may be taken to be constant. In that case the '''concentration quotient''', K<sub>c</sub>,
:<math>K_c=\frac{[S]^\sigma [T]^\tau } {[A]^\alpha [B]^\beta}</math>
where [A] is the [[concentration]] of A, etc., is independent of the [[analytical concentration]] of the reactants. For this reason, equilibrium constants for [[solution]]s are usually [[Determination of equilibrium constants|determined]] in media of high ionic strength. K<sub>c</sub> varies with ionic strength, temperature and pressure (or volume). Likewise K<sub>p</sub> for gases depends on [[partial pressure]].  These constants are easier to measure and encountered in high-school chemistry courses.

==Thermodynamics==

The relationship between the Gibbs energy and the equilibrium constant can be found by considering chemical potentials. The thermodynamic [[Thermodynamic equilibrium|condition]] for chemical equilibrium is<ref>P.W. Atkins, Physical Chemistry, Oxford University Press, date</ref>
 
* At constant pressure <U+0394>G=0 (<U+0394>G is the change [[Gibbs free energy]] for the reaction)
* At constant volume <U+0394>A=0 (<U+0394>A is the change in [[Helmholtz free energy]] for the reaction)
In this article only the constant pressure case is considered. The constant volume case is important in [[geochemistry]] and [[atmospheric chemistry]] where pressure variations are significant. Note that if reactants and products were in standard state (completely pure) then there would be no reversibility and no equilibrium. The mixing of the products and reactants contributes a large entropy (known as [[entropy of mixing]]) to states containing equal mixture of products and reactants. The combination of the standard Gibbs energy change and the Gibbs energy of mixing determines the equilibrium state.<ref>a) Mary Jane Schultz. Why Equilibrium? Understanding the Role of Entropy of Mixing. ''Journal of Chemical Education'' '''1999''', ''76'', 1391. b) Clugston, Michael J. A mathematical verification of the second law of thermodynamics from the entropy of mixing. ''Journal of Chemical Education'' '''1990''', ''67'', 203.</ref>

In general an equilibrium system is defined by writing an equilibrium equation for the reaction

:<math> \alpha A + \beta B \rightleftharpoons \sigma S + \tau T</math>

To meet the thermodynamic condition for equilibrium the Gibbs energy must be stationary, meaning that the derivative of G with respect to [[reaction coordinate]] (<U+0394>G) must be zero. It can be shown that <U+0394>G is in fact equal to the difference between the [[chemical potential]]s of the products and those of the reactants. Therefore, the sum of the Gibbs energies of the reactants must be the equal to the sum of the Gibbs energies of the products.
:<math> \alpha \mu_A + \beta \mu_B = \sigma \mu_S + \tau \mu_T \,</math>

where [[Mu (letter)|<U+03BC>]] is in this case a partial molar Gibbs energy, a [[chemical potential]]. The chemical potential of a reagent A is a function of the
[[Activity (chemistry)|activity]], {A} of that reagent.

:<math> \mu_A = \mu_{A}^{\ominus} + RT \ln\{A\} \,</math>

Substituting expressions like this into the [[Gibbs energy|Gibbs energy equation]]:

:<math> \Delta G = Vdp-SdT+\sum_{i=1}^k \mu_i dN_i + \sum_{i=1}^n X_i da_i + \ldots \,</math>

which at constant pressure and temperature becomes:

:<math> \Delta G =\sum_{i=1}^k \mu_i N_i</math>

results in:

:<math> \Delta G =  \sigma \mu_{S} + \tau \mu_{S} - \alpha \mu_{S} - \beta \mu_{S}  \,</math>

By substituting the chemical potentials:

:<math> \Delta G = ( \sigma \mu_{S}^{\ominus} + \tau \mu_{S}^{\ominus} ) - ( \alpha \mu_{S}^{\ominus} - \beta \mu_{S}^{\ominus} ) + ( \sigma RT \ln\{S\} + \tau RT \ln\{T\} ) - ( \alpha RT \ln\{A\} + \beta RT \ln \{B\} ) </math>

the relationship becomes:

:<math> \Delta G =\sum_{i=1}^k \mu_i^\ominus v_i + RT ln \frac{\{S\}^\sigma \{T\}^\tau} {\{A\}^\alpha \{B\}^\beta} </math>

At equilibrium <math> \Delta G = 0 \,</math> and therefore 

:<math> \sum_{i=1}^k \mu_i^\ominus v_i + RT ln \frac{\{S\}^\sigma \{T\}^\tau} {\{A\}^\alpha \{B\}^\beta} = 0</math>

leading to:

:<math> \Delta G_m^{\ominus} = -RT \ln K </math>

<U+0394>G<sub>m</sub><sup><s>O</s></sup> is the standard molar Gibbs energy change for the reaction and ''K'' is the [[equilibrium constant]].  Note that activities and equilibrium constants are dimensionless numbers.

===Treatment of activity===

The expression for the equilibrium constant can be re-written as the product of a concentration quotient, ''K''<sub>c</sub> and an [[activity coefficient]] quotient, <U+0393>.
:<math>K=\frac{{[S]} ^\sigma {[T]}^\tau ... } {{[A]}^\alpha {[B]}^\beta ...}
\times \frac{{\gamma_S} ^\sigma {\gamma_T}^\tau ... } {{\gamma_A}^\alpha {\gamma_B}^\beta ...} = K_c \Gamma</math>
 
[A] is the concentration of reagent A etc. It is possible in principle to obtain values of the activity coefficients, <U+03B3>. For solutions  equations such as the [[Debye-H<U+00FC>ckel equation]] or extensions such as Davies equation<ref> C.W. Davies, ''Ion Association'',Butterworths, 1962</ref> or Pitzer equations<ref name="davies">I. Grenthe and H. Wanner, ''Guidelines for the extrapolation to zero ionic strength'',  http://www.nea.fr/html/dbtdb/guidelines/tdb2.pdf</ref>
may be used.<sup>[[#Software for chemical equilibria|Software (below)]]</sup>. However this is not always possible. It is common practice to assume that <U+0393> is a constant and to use the concentration quotient in place of the thermodynamic equilibrium constant. It is also general practice to use the term equilibrium constant instead of the more pedantically accurate concentration quotient. This practice will be followed here.

For reactions in the gas phase [[partial pressure]] is used in place of concentration and [[fugacity coefficient]] in place of activity coefficient. In the real world, for example when making [[Haber process|ammonia]] industrially, fugacity coefficients must be taken into account. Fugacity, ''f'', is the product of partial pressure and fugacity coefficient. The chemical potential of a species in the gas phase is given by
:<math>\mu = \mu^{\Theta} + RT \ln \left( \frac{f}{bar} \right) + RT \ln \gamma</math>   
so the general expression defining an equilibrium constant is valid for both solution and gas phases. 

===Justification for the use of concentration quotients===

In aqueous solution, equilibrium constants are usually determined in the presence of an "inert" electrolyte such as [[sodium nitrate]] NaNO<sub>3</sub> or [[Potassium perchlorate]] KClO<sub>4</sub>. The [[ionic strength]], ''I'', of a solution containing a dissolved salt, X<sup>+</sup>Y<sup>-</sup>, is given by
:<math> I = \frac{1}{2}\left(c_X z_X^2 + c_Y z_Y^2 + \sum_{i=1}^n c_i z_i^2\right) </math>
where ''c'' stands for concentration, ''z'' stands for ionic charge and the sum is taken over all the species in equilibrium. When the concentration of dissolved salt is much higher than the analytical concentrations of the reagents, the ionic strength is effectively constant. Since activity coefficients depend on ionic strength the activity coefficients of the species are effectively independent of concentration. Thus, the assumption that [[Gamma|<U+0393>]] is constant is justified. The concentration quotient is a simple multiple of the equilibrium constant.<ref>F.J,C. Rossotti and H. Rossotti, ''The Determination of Stability Constants'', McGraw-Hill, 1961</ref>
:<math> K_c = \frac{K}{\Gamma} </math>
However, ''K''<sub>c</sub> will vary with ionic strength. If it is measured at a series of different ionic strengths the value can be extrapolated to zero ionic strength.<ref name="davies"/> The concentration quotient obtained in this manner is known, paradoxically, as a thermodynamic equilibrium constant.

To use a published value of an equilibrium constant in conditions of ionic strength different from the conditions used in its determination, the value should be adjusted<sup>[[#Software for chemical equilibria|Software (below)]]</sup>.

=== Metastable mixtures ===

A mixture may be appear to have no tendency to change, though it is not at equilibrium. For example, a mixture of [[Sulfur dioxide|SO<sub>2</sub>]] and [[oxygen|O<sub>2</sub>]] is [[metastable]] as there is a [[Activation energy|kinetic barrier]] to formation of the product, [[Sulfur trioxide|SO<sub>3</sub>]].  
:2SO<sub>2</sub> + O<sub>2</sub> <math>\rightleftharpoons</math> 2SO<sub>3</sub>

The barrier can be overcome when a [[Catalysis|catalyst]] is also present in the mixture as in the [[Contact process]], but the catalyst does not affect the equilibrium concentrations.

Likewise, the formation of [[bicarbonate]] from [[carbon dioxide]] and [[water]] is very slow under normal conditions
:CO<sub>2</sub> + H<sub>2</sub>O <math>\rightleftharpoons</math> HCO<sub>3</sub><sup>-</sup> +H<sub>3</sub>O<sup>+</sup> 
but almost instantaneous in the presence of the catalytic [[enzyme]] [[carbonic anhydrase]].

==Pure compounds in equilibria==
When pure substances (liquids or solids) are involved in equilibria they do not appear in the equilibrium equation <ref name=CEM>''Concise Encyclopedia Chemistry'' 1994 ISBN 0899254578</ref>

Applying the general formula for an equilibrium constant to the specific case of ethanoic acid one obtains
:<math>CH_3CO_2H + H_2O \rightleftharpoons CH_3CO_2^- + H_3O^+</math>

:<math>K_c=\frac{[{CH_3CO_2}^-][{H_3O}^+]} {[{CH_3CO_2H}][{H_2O}]}</math>
 
It may be assumed that the concentration of water is constant. This assumption will be valid for all but very concentrated solutions. The equilibrium constant expression is therefore usually written as 
:<math>K=\frac{[{CH_3CO_2}^-][{H_3O}^+]} {[{CH_3CO_2H}]}</math>

where now 

<math>K=K_c*[H_2O]\,</math> 

a constant factor is incorporated into the equilibrium constant.

A particular case is the [[self-ionization of water]] itself

:<math>H_2O + H_2O \rightleftharpoons  H_3O^+ + OH^-</math>

The self-ionization constant of water is defined as

<math>K_w = [H^+][OH^-]\,</math> 

It is perfectly legitimate to write [H<sup>+</sup>] for the [[hydronium ion]] concentration since the state of [[solvation]] of the proton is constant (in dilute solutions) and so does not affect the equilibrium concentrations. K<sub>w</sub> varies with variation in ionic strength and/or temperature.

The concentrations of H<sup>+</sup> and OH<sup>-</sup> are not independent quantities. Most commonly [OH<sup>-</sup>] is replaced by ''K''<sub>w</sub>[H<sup>+</sup>]<sup>-1</sup> in equilibrium constant expressions which would otherwise [[hydroxide]].

Solids also do not appear in the equilibrium equation. An example is the [[Boudouard reaction]] <ref name=CEM/>:

:<math>2CO  \rightleftharpoons  CO_2 + C </math>

for which the equation (without solid carbon) is written as:

:<math>K_c=\frac{[CO]^2} {[CO_2]}</math>

==Multiple equilibria==

Consider the case of a dibasic acid H<sub>2</sub>A. When dissolved in water the mixture will contain H<sub>2</sub>A, HA<sup>-</sup> and A<sup>2-</sup>. This equilibrium can be split into two steps in each of which one proton is liberated.
:<math>H_2A \rightleftharpoons HA^- + H^+ :K_1=\frac{[HA^-][H^+]} {[H_2A]}</math>
:<math>HA^- \rightleftharpoons A^{2-} + H^+ :K_2=\frac{[A^{2-}][H^+]} {[HA^-]}</math>
''K''<sub>1</sub> and'' K''<sub>2</sub> are examples of ''stepwise'' equilibrium constants. The ''overall'' equilibrium constant,<math>\beta_D</math>, is product of the stepwise constants. 
:<math>H_2A \rightleftharpoons A^{2-} + 2H^+ :\beta_D = \frac{[A^{2-}][H^+]^2} {[H_2A]}=K_1K_2</math>
Note that these constants are [[Acid dissociation constant|dissociation constants]] because the products on the right hand side of the equilibrium expression are dissociation products. In many systems it is preferable to use association constants. 
:<math>A^{2-} + H^+ \rightleftharpoons HA^-  :\beta_1=\frac {[HA^-]} {[A^{2-}][H^+]}</math>  
:<math>A^{2-} + 2H^+ \rightleftharpoons H_2A  :\beta_2=\frac {[H_2A]} {[A^{2-}][H^+]^2}</math>  
<U+03B2><sub>1</sub> and <U+03B2><sub>2</sub> are examples of association constants. Clearly <U+03B2><sub>1</sub> = 1/''K''<sub>2</sub> and <U+03B2><sub>2</sub> = 1/<U+03B2><sub>D</sub>; lg <U+03B2><sub>1</sub> = pK<sub>2</sub> and lg <U+03B2><sub>2</sub> = pK<sub>2</sub> + pK<sub>1</sub><ref>M.T. Beck, ''Chemistry of Complex Equilibria'', Van Nostrand, 1970. 2nd. Edition by M.T. Beck and I Nagyp<U+00E1>l, Akad<U+00E9>miai Kaid<U+00F3>, Budapest, 1990.</ref>

==Effect of temperature change on an equilibrium constant==

The effect of changing temperature on an equilibrium constant is given by the [[Van't Hoff equation|van<U+2019>t Hoff equation]]
:<math>\frac {d\ln K} {dT} = \frac{{\Delta H_m}^{\Theta}} {RT^2}</math> 
Thus, for [[exothermic]] reactions, (<U+0394>H is negative) ''K'' decreases with temperature, but for [[endothermic]] reactions (<U+0394>H is positive) ''K'' increases with temperature. An alternative formulation is
:<math>\frac {d\ln K} {d(1/T)} = -\frac{{\Delta H_m}^{\Theta}} {R}</math>  
At first sight this appears to offer a means of obtaining the standard molar enthalpy of the reaction by studying the variation of ''K'' with temperature. In practice, however, the method is unreliable because error propagation almost always gives very large errors on the values calculated in this way.

==Types of equilibrium and some applications==
# In the gas phase. [[Rocket engine]]s <ref>NASA Reference publication 1311, [http://gltrs.grc.nasa.gov/reports/1994/RP-1311.pdf Computer Program for Calculation of Complex Chemical Equilibrium Compositions and Applications]</ref>, industrial synthesis such as [[ammonia]], [[atmospheric chemistry]].
# Seawater and other natural waters. [[Chemical oceanography]].
# Distribution between two phases. 
## [[LogD-Distribution coefficient]] Important for pharmaceuticals where lipophilicity is a significant property of a drug.
## [[Liquid-liquid extraction]], [[Ion exchange]], [[Chromatography]].
## [[Solubility equilibrium|Solubility product]].
## Uptake and release of oxygen by [[haemoglobin]] in blood
# Acid/base equilibria. [[Acid dissociation constant]], [[hydrolysis]], [[buffer solution]]s, [[indicators]], [[acid-base homeostasis]]
# Metal-ligand complexation. [[Chelation|sequestering agents]], [[chelation therapy]], [[Magnetic resonance imaging|MRI contrast reagents]], [[Schlenk equilibrium]]
# Adduct formation. [[Host-guest chemistry]], [[supramolecular chemistry]], [[molecular recognition]], [[dinitrogen tetroxide]]   
# In certain [[oscillating reaction]]s the approach to equilibrium is not asymptotically but in the form of a damped oscillation <ref name=CEM/>.
# The related [[Nernst equation]] in electrochemistry gives the difference in electrode potential as a function of redox concentrations.
# When molecules on each side of the equilibrium are able to further react irreversibly in secondary reactions the final product ratio is determined according to the [[Curtin-Hammett principle]].


In these applications terms such as stability constant, formation constant, binding constant, affinity constant, association/dissociation constant are used. In biochemistry it is common to give units for binding constants, which serve to define the concentration units used when  the constant<U+2019>s value was determined.

==Composition of an equilibrium mixture==

When the only equilibrium is that of the formation of a 1:1 adduct as the composition of a mixture, there are any number of ways that the composition of a mixture can be calculated. For example, see [[ICE table]] for a traditional method of calculating the pH of a solution of a weak acid.

There are three approaches to the general calculation of the composition of a mixture at equilibrium.

#The most basic approach is to manipulate the various equilibrium constants until the desired concentrations are expressed in terms of measured equilibrium constants (equivalent to measuring chemical potentials) and initial conditions.
#Minimize the Gibbs energy of the system. <ref> This  approach is described in detail in Smith and Missen: 
W. R. Smith and R. W. Missen, ''Chemical Reaction Equilibrium Analysis: Theory and Algorithms'', , Krieger Publishing, Malabar, Fla, 1991 (a reprint, with corrections, of the same title by Wiley-Interscience, 1982). A comprehensive treatment of the theory of chemical reaction equilibria and its computation. Details at [http://www.mathtrek.com http://www.mathtrek.com/]</ref>
# Satisfy the equation of [[mass balance]]. The equations of mass balance are simply statements that the total concentration of each reactant must be constant by the law of [[conservation of mass]].

=== Solving the equations of mass-balance ===

In general the calculations are rather complicated. For instance, in the case of a dibasic acid, H<sub>2</sub>A dissolved in water the two reactants can be specified as the [[conjugate base]], A<sup>2-</sup>, and the [[hydronium|proton]], H<sup>+</sup>. The following equations of mass-balance could apply equally well to a base such as [[Ethylenediamine|1,2-diaminoethane]], in which case the base itself is designated as the reactant A:
:<math>T_A = [A] + [HA] +[H_2A] \,</math>
:<math>T_H = [H] + [HA] + 2[H_2A] - [OH] \,</math> 

With T<sub>A</sub> the total concentration of species A. Note that it is customary to omit the ionic charges when writing and using these equations.

When the equilibrium constants are known and the total concentrations are specified there are two equations in two unknown "free concentrations" [A] and [H]. This follows from the fact that [HA]= <U+03B2><sub>1</sub>[A][H], [H<sub>2</sub>A]= <U+03B2><sub>2</sub>[A][H]<sup>2</sup> and [OH] = K<sub>w</sub>[H]<sup>-1</sup>

:<math> T_A = [A] + \beta_1[A][H] +  \beta_2[A][H]^2 \,</math>
:<math> T_H = [H] + \beta_1[A][H] + 2\beta_2[A][H]^2 - K_w[H]^{-1} \,</math>

so the concentrations of the "complexes" are calculated from the free concentrations and the equilibrium constants.
General expressions applicable to all systems with two reagents, A and B would be
:<math>T_A=[A]+\sum_i{p_i \beta_i[A]^{p_i}[B]^{q_i}}</math>
:<math>T_B=[B]+\sum_i{q_i \beta_i[A]^{p_i}[B]^{q_i}}</math>
	 
It is easy to see how this can be extended to three or more reagents.

==== Composition for polybasic acids as a function of pH ====
 
The composition of solutions containing reactants A and H is easy to calculate as a function of [[pH|p[H]]]. When [H] is known the free concentration [A] is calculated from the mass-balance equation in A. Here is an example of the results that can be obtained.

[[Image:AL hydrolysis.png]]

This diagram, for the hydrolysis of the [[aluminum]] [[Lewis acid]] Al<sup>3+</sup><sub>aq</sub> <ref>The diagram was created with the program [http://www.hyperquad.co.uk/hyss.htm HySS]</ref> shows the species concentrations for a 5<U+00D7>10<sup>-6</sup>M solution of an aluminium salt as a function of pH. Each concentration is shown as a percentage of the total aluminium.

==== Solution equilibria with precipitation ====
The diagram above illustrates the point that a [[Precipitation (chemistry)|precipitate]] may be formed which is not one of the main species in the solution equilibrium. At pH just below 5.5 the main species present in a 5<U+03BC>M solution of Al<sup>3+</sup> are [[aluminum hydroxide]]s Al(OH)<sup>2+</sup>, Al(OH)<sub>2</sub><sup>+</sup> and Al<sub>13</sub>(OH)<sub>32</sub><sup>7+</sup>, but on raising the pH [[aluminium hydroxide|Al(OH)<sub>3</sub>]] precipitates from the solution. This occurs because Al(OH)<sub>3</sub> has a very large [[lattice energy]]. As the pH rises more and more Al(OH)<sub>3</sub> comes out of solution. This is an example of [[Le Chatelier's principle]] in action: increasing the concentration of the hydroxide ion causes more aluminium hydroxide to precipitate, which removes hydroxide from the solution. When the hydroxide concentration becomes sufficiently high the soluble aluminate, Al(OH)<sub>4</sub><sup>-</sup>, is formed. 

Another common instance where precipitation occurs is when a metal cation interacts with an anionic ligand to form an electrically neutral complex. If the complex is [[hydrophopbic]] it will precipitate out of water. This occurs with the [[nickel]] ion Ni<sup>2+</sup> and [[dimethylglyoxime]], (dmgH<sub>2</sub>): in this case the lattice energy of the solid is not particularly large, but it greatly exceeds the energy of [[solvation]] of the molecule Ni(dmgH)<sub>2</sub>.  

=== Minimisation of Gibbs energy ===

At equilibrium, ''G'' is at a minimum:

:<math>dG= \sum_{j=1}^m \mu_j\,dN_j = 0</math>

For a closed system, no particles may enter or leave, although they may combine in various ways. The total number of atoms of each element will remain constant. This means that the minimization above must be subjected to the constraints:

:<math>\sum_{j-1}^m a_{ij}N_j=b_i^0</math>

where <math>a_{ij}</math> is the number of atoms of element ''i'' in molecule ''j'' and ''b''<sub>i</sub><sup>0</sup> is the total number of atoms of element ''i'', which is a constant, since the system is closed. If there are a total of ''k'' types of atoms in the system, then there will be ''k'' such equations.

This is a standard problem in [[Optimization (mathematics)|optimisation]], known as [[constrained minimisation]]. The most common method of solving it is using the method of [[Lagrange multipliers]], also known as [[undetermined multipliers]] (though other methods may be used).

Define:

:<math>\mathcal{G}= G + \sum_{i=1}^k\lambda_i\left(\sum_{j-1}^m a_{ij}N_j-b_i^0\right)=0</math>

where the <math>\lambda_i</math> are the Lagrange multipliers, one for each element. This allows each of the <math>N_j</math> to be treated independently, and it can be shown using the tools of [[multivariate calculus]] that the equilibrium condition is given by

:<math>\frac{\partial \mathcal{G}}{\partial N_j}=0</math> &nbsp;&nbsp;&nbsp; and &nbsp;&nbsp;&nbsp; <math>\frac{\partial \mathcal{G}}{\partial \lambda_i}=0</math>

(For proof see [[Lagrange multipliers]])

This is a set of ''(m+k)'' equations in ''(m+k)'' unknowns (the <math>N_j</math> and the <math>\lambda_i</math>) and may therefore be solved for the equilibrium concentrations <math>N_j</math> as long as the chemical potentials are known as functions of the concentrations at the given temperature and pressure. (See [[Thermodynamic databases for pure substances]]).

This method of calculating equilibrium chemical concentrations is useful for systems with a large number of different molecules. The use of ''k'' atomic element conservation equations for the mass constraint is straightforward, and replaces the use of the stoichiometric coefficient equations. <ref>{{cite journal
 | last = Gordon
 | first = Sanford 
 | coauthors = McBride, Bonnie J.
 | year = 1994
 | month = October
 | title = Computer Program for Calculation of Complex Chemical Equilibrium Compositions and Applications
 | journal = NASA Reference publication 1311 
 | url = http://gltrs.grc.nasa.gov/reports/1994/RP-1311.pdf
 | format = PDF
 | accessdate = 2006-11-07}}</ref>

== See also ==
*[[Determination of equilibrium constants]]
*[[Henderson-Hasselbalch equation]]
*[[Michaelis-Menten kinetics]]
*[[Standard electrode potential|Redox equilibria]]
*[[Thermodynamic databases for pure substances]]

==References==
<references/>

== Further reading ==
*F. Van Zeggeren and S.H. Storey, ''The Computation of Chemical Equilibria'', Cambridge University Press, 1970. Mainly concerned with gas-phase equilibria.
*D. J. Leggett (editor), ''Computational Methods for the Determination of Formation Constants'', Plenum Press, 1985.
*A.E. Martell and R.J. Motekaitis, ''The Determination and Use of Stability Constants'', Wiley-VCH, 1992.
*P. Gans, ''Stability Constants: Determination and Uses, an interactive CD, ''Protonic Software (Leeds), 2004 

==External links==
===Computer programs for calculating species concentrations===
There are ''n'' mass-balance equations in ''n'' unknown free concentrations. This constitutes a set of non-linear equations which must be solved by a method of successive approximations. The most commonly used method is the [[Newton-Raphson]] method and this has been the subject of numerous publications.  Some general computer programs are listed here.
*[http://www.hyperquad.co.uk/hyss.htm HySS] Titration simulation and speciation calculations. 
*[http://www.mathtrek.com EQS4WIN] A powerful computer program originally developed for gas-phase equilibria but subsequently extended to general applications. Uses the Gibbs energy minimization approach.
*[http://www.eawag.ch/research_e/surf/Researchgroups/sensors_and_analytic/chemeql.html CHEMEQL]A comprehensive computer program for the calculation of thermodynamic equilibrium concentrations of species in homogeneous and heterogeneous systems. Many geochemical applications.
*[http://www.chem.umu.se/dep/inorgchem/samarbeta/WinSGW_eng.stm WinSGW] A Windows version of the SOLGASWATER computer program.
*[http://www.lwr.kth.se/English/OurSoftware/vminteq Visual MINTEQ] A Windows version of MINTEQA2 (ver 4.0). [http://www.epa.gov/ceampubl/mmedia/minteq/index.htm MINTEQA2] is a chemical equilibrium model for the calculation of metal speciation, solubility equilibria etc. for natural waters. 

=== Software for chemical equilibria  ===
*[http://public.kubsu.ru/aquasolsoft Aqua solution software] A set of five computer programs for 
*Specific Interaction Theory. An editable database of published SIT parameters. Estimation of SIT parameters and adjustment of stability constants for changes in ionic strength.
*Calculation of electrolyte activity coefficients, ionic activity coefficients, osmotic coefficients
*Calculation of acid-base equilibria in electrolyte solutions and sea water
*Calculation of O<sub>2</sub> solubility in water, electrolyte solutions, natural fluids and seawater as a function of temperature, concentration, salinity, altitude, external pressure, humidity
*Prediction of temperature dependence of lg K values using various thermodynamic models
*[http://jess.murdoch.edu.au/jess/jess_home.htm JESS]:A powerful research tool for thermodynamic and kinetic modelling of chemical speciation in complex aqueous environments.
*[http://www.changbioscience.com/biochem/keq.html Chemical Equilibrium Calculator]
[[Category:Analytical chemistry]]
[[Category:Physical chemistry]]

[[bg:<U+0425><U+0438><U+043C><U+0438><U+0447><U+043D><U+043E> <U+0440><U+0430><U+0432><U+043D><U+043E><U+0432><U+0435><U+0441><U+0438><U+0435>]]
[[ca:Equilibri qu<U+00ED>mic]]
[[cs:Chemick<U+00E1> rovnov<U+00E1>ha]]
[[da:Kemisk ligev<U+00E6>gt]]
[[de:Chemisches Gleichgewicht]]
[[es:Equilibrio qu<U+00ED>mico]]
[[gl:Equilibrio qu<U+00ED>mico]]
[[it:Equilibrio chimico]]
[[he:<U+05E9><U+05D9><U+05D5><U+05D5><U+05D9> <U+05DE><U+05E9><U+05E7><U+05DC> <U+05DB><U+05D9><U+05DE><U+05D9>]]
[[hu:Dinamikus egyens<U+00FA>ly]]
[[nl:Evenwichtsreactie]]
[[ja:<U+5316><U+5B66><U+5E73><U+8861>]]
[[no:Kjemisk likevekt]]
[[pl:R<U+00F3>wnowaga reakcji chemicznych]]
[[pt:Equil<U+00ED>brio qu<U+00ED>mico]]
[[ru:<U+0425><U+0438><U+043C><U+0438><U+0447><U+0435><U+0441><U+043A><U+043E><U+0435> <U+0440><U+0430><U+0432><U+043D><U+043E><U+0432><U+0435><U+0441><U+0438><U+0435>]]
[[sr:<U+0425><U+0435><U+043C><U+0438><U+0458><U+0441><U+043A><U+0430> <U+0440><U+0430><U+0432><U+043D><U+043E><U+0442><U+0435><U+0436><U+0430>]]
[[sv:Kemisk j<U+00E4>mvikt]]
[[tr:Kimyasal denge]]
